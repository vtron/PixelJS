if(!Function.prototype.bind)Function.prototype.bind=function(a){if(typeof this!=="function")throw new TypeError("Function.prototype.bind - what is trying to be fBound is not callable");var c=Array.prototype.slice.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:a||window,c.concat(Array.prototype.slice.call(arguments)))};e.prototype=this.prototype;f.prototype=new e;return f};
typeof Pixel=="undefined"?(Pixel={version:"0.5"},typeof px=="undefined"&&(px=Pixel)):console.log("Pixel Namespace Already Exists!");Pixel.BROWSER_TYPE_CHROME="chrome";Pixel.BROWSER_TYPE_SAFARI="safari";Pixel.BROWSER_TYPE_FIREFOX="firefox";Pixel.BROWSER_TYPE_IPHONE="iphone";Pixel.RENDER_MODE_2D=0;Pixel.RENDER_MODE_WEBGL=1;Pixel.TEXT_ALIGN_LEFT="left";Pixel.TEXT_ALIGN_CENTER="center";Pixel.TEXT_ALIGN_RIGHT="right";Pixel.TEXT_BASELINE_TOP="top";Pixel.TEXT_BASELINE_HANGING="hanging";
Pixel.TEXT_BASELINE_MIDDLE="middle";Pixel.TEXT_BASELINE_BOTTOM="bottom";Pixel.OBJECT_SHAPE_RECT=0;Pixel.OBJECT_SHAPE_CIRCLE=1;Pixel.ORIGIN_TOP_LEFT=0;Pixel.ORIGIN_CENTER_LEFT=1;Pixel.ORIGIN_BOTTOM_LEFT=2;Pixel.ORIGIN_TOP_RIGHT=3;Pixel.ORIGIN_CENTER_RIGHT=4;Pixel.ORIGIN_BOTTOM_RIGHT=5;Pixel.ORIGIN_TOP_CENTER=6;Pixel.ORIGIN_BOTTOM_CENTER=7;Pixel.ORIGIN_CENTER=8;Pixel.isSet=function(a){return a!=void 0?a:!1};Pixel.log=function(a){console.log("PixelJS Log: "+a)};
Pixel.isTouchDevice=function(){return"ontouchstart"in window};window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();Pixel.getRelativeMouseCoords=function(a,c){var d=0,e=0,f=0,h=0,f=c;do d+=f.offsetLeft,e+=f.offsetTop;while(f=f.offsetParent);f=a.pageX-d;h=a.pageY-e;return{x:f,y:h}};
Pixel.Rectangle=function(a,c,d,e){this.height=this.width=this.y=this.x=0;this.set(a,c,d,e)};Pixel.Rectangle.prototype.initialize=function(a,c,d,e){this.set(a,c,d,e)};Pixel.Rectangle.prototype.set=function(a,c,d,e){this.setPos(a,c);this.setSize(d,e)};Pixel.Rectangle.prototype.setPos=function(a,c){if(Pixel.isSet(a))this.x=a;if(Pixel.isSet(c))this.y=c};Pixel.Rectangle.prototype.setSize=function(a,c){this.width=a;this.height=c};Pixel.Rectangle.prototype.getPos=function(){return{x:this.x,y:this.y}};
Pixel.Rectangle.prototype.getSize=function(){return{width:this.width,height:this.height}};Pixel.Rectangle.prototype.isInside=function(a,c){return a>this.x&&a<this.x+this.width&&c>this.y&&c<this.y+this.height};Pixel.radToDeg=function(a){return a*(180/Math.PI)};Pixel.degToRad=function(a){return a*(Math.PI/180)};Pixel.map=function(a,c,d,e,f,h){a=e+(f-e)*((a-c)/(d-c));return h?Pixel.clamp(a):a};Pixel.clamp=function(a,c,d){a=Math.max(a,c);return a=Math.min(a,d)};
Pixel.dist=function(a,c,d,e,f){a=Math.sqrt(Math.pow(d-a,2)+Math.pow(e-c,2));return f?a:Math.abs(a)};Pixel.getAngle=function(a,c,d,e){return Math.atan2(e-c,d-a)};Pixel.EventDispatcher=function(){this.events=[]};Pixel.EventDispatcher.prototype.addEventListener=function(a,c){this.events[a]=this.events[a]||[];this.events[a]&&this.events[a].push(c)};
Pixel.EventDispatcher.prototype.removeEventListener=function(a,c){if(this.events[a])for(var d=this.events[a],e=d.length-1;e>=0;--e)if(d[e]===c)return d.splice(e,1),!0;return!1};Pixel.EventDispatcher.prototype.dispatch=function(a,c){if(this.events[a])for(var d=this.events[a],e=d.length;e--;)d[e](c)};Pixel.Renderer=function(){Pixel.EventDispatcher.call(this)};Pixel.Renderer.prototype=new Pixel.EventDispatcher;
Pixel.Renderer.prototype.setRenderer=function(a,c){switch(c){case Pixel.RENDER_MODE_2D:this.renderer=new Pixel.Renderer2D(a);break;case Pixel.RENDER_MODE_WEBGL:Pixel.log("WebGL Renderer not yet implemented!")}};Pixel.Renderer.prototype.clear=function(a,c,d,e){this.renderer.clear(a,c,d,e)};Pixel.Renderer.prototype.setColor=function(a,c,d,e){this.renderer.setColor(a,c,d,e)};Pixel.Renderer.prototype.useColor=function(a){this.renderer.useColor(a)};Pixel.Renderer.prototype.fill=function(){this.renderer.fill()};
Pixel.Renderer.prototype.noFill=function(){this.renderer.noFill()};Pixel.Renderer.prototype.stroke=function(a){this.renderer.stroke(a)};Pixel.Renderer.prototype.noStroke=function(){this.renderer.noStroke()};Pixel.Renderer.prototype.drawImage=function(a,c,d){this.renderer.drawImage(a,c,d)};Pixel.Renderer.prototype.beginShape=function(a,c){this.renderer.beginShape(a,c)};Pixel.Renderer.prototype.addVertex=function(a,c,d){this.renderer.addVertex(a,c,d)};
Pixel.Renderer.prototype.endShape=function(a,c){this.renderer.endShape(a,c)};Pixel.Renderer.prototype.drawLine=function(a,c,d,e){this.renderer.drawLine(a,c,d,e)};Pixel.Renderer.prototype.dashedLine=function(a,c,d,e,f){this.renderer.dashedLine(a,c,d,e,f)};Pixel.Renderer.prototype.drawRect=function(a,c,d,e){this.renderer.drawRect(a,c,d,e)};Pixel.Renderer.prototype.drawSquare=function(a,c,d){this.renderer.drawSquare(a,c,d)};Pixel.Renderer.prototype.drawEllipse=function(){this.renderer.drawEllipse()};
Pixel.Renderer.prototype.drawCircle=function(a,c,d){this.renderer.drawCircle(a,c,d)};Pixel.Renderer.prototype.pushMatrix=function(){this.renderer.pushMatrix()};Pixel.Renderer.prototype.popMatrix=function(){this.renderer.popMatrix()};Pixel.Renderer.prototype.translate=function(a,c){this.renderer.translate(a,c)};Pixel.Renderer.prototype.scale=function(a,c){this.renderer.scale(a,c)};Pixel.Renderer.prototype.rotate=function(a){this.renderer.rotate(a)};
Pixel.Renderer.prototype.transform=function(a,c,d,e,f,h){this.renderer.transform(a,c,d,e,f,h)};Pixel.Renderer.prototype.setTransform=function(a,c,d,e,f,h){this.renderer.setTransform(a,c,d,e,f,h)};Pixel.Renderer.prototype.setFont=function(a,c){this.renderer.setFont(a,c)};Pixel.Renderer.prototype.setTextAlignment=function(a){this.renderer.setTextAlignment(a)};Pixel.Renderer.prototype.setTextBaseline=function(a){this.renderer.setTextBaseline(a)};Pixel.Renderer.prototype.getTextWidth=function(a){return this.renderer.getTextWidth(a)};
Pixel.Renderer.prototype.drawText=function(a,c,d){c!=void 0?this.renderer.drawText(a,c,d):this.renderer.drawText(a,this.cursorX,this.cursorY)};Pixel.Renderer.prototype.drawTextfield=function(a){this.renderer.drawTextfield(a)};Pixel.Renderer2D=function(a){this.ctx=a.getContext("2d");this.bFill=!0;this.bStroke=!1};Pixel.Renderer2D.prototype.clear=function(a,c,d,e){this.ctx.clearRect(a,c,d,e)};
Pixel.Renderer2D.prototype.setColor=function(a,c,d,e){a=Math.round(a);c=Math.round(c);d=Math.round(d);c==void 0?(this.ctx.fillStyle="rgb("+a+","+a+","+a+")",this.ctx.strokeStyle="rgb("+a+","+a+","+a+")"):e==void 0?(this.ctx.fillStyle="rgb("+a+","+c+","+d+")",this.ctx.strokeStyle="rgb("+a+","+c+","+d+")"):(this.ctx.fillStyle="rgba("+a+","+c+","+d+","+e+")",this.ctx.strokeStyle="rgba("+a+","+c+","+d+","+e+")")};
Pixel.Renderer2D.prototype.useColor=function(a){this.ctx.fillStyle="rgba("+a.r+","+a.g+","+a.b+","+a.a+")";this.ctx.strokeStyle="rgba("+a.r+","+a.g+","+a.b+","+a.a+")"};Pixel.Renderer2D.prototype.fill=function(){this.bFill=!0};Pixel.Renderer2D.prototype.noFill=function(){this.bFill=!1};Pixel.Renderer2D.prototype.stroke=function(a){this.bStroke=!0;this.ctx.lineWidth=a};Pixel.Renderer2D.prototype.noStroke=function(){this.bStroke=!1};
Pixel.Renderer2D.prototype.drawImage=function(a,c,d){c=c||a.getPos().x;d=d||a.getPos().y;a.isLoaded()?this.ctx.drawImage(a.image,c,d):Pixel.log("Image not yet loaded!")};Pixel.Renderer2D.prototype.beginShape=function(a,c){this.ctx.beginPath();this.ctx.moveTo(a,c)};Pixel.Renderer2D.prototype.addVertex=function(a,c,d){this.ctx.lineTo(a,c);d!=void 0&&this.endShape()};Pixel.Renderer2D.prototype.endShape=function(){this.ctx.closePath();this.ctx.fill()};
Pixel.Renderer2D.prototype.drawLine=function(a,c,d,e){this.ctx.beginPath();this.ctx.moveTo(a,c);this.ctx.lineTo(d,e);this.ctx.stroke()};
Pixel.Renderer2D.prototype.dashedLine=function(a,c,d,e,f){var h=function(a,c){return a<=c},i=function(a,c){return a>=c},j=function(a,c){return Math.min(a,c)},k=function(a,c){return Math.max(a,c)},l={thereYet:i,cap:j},i={thereYet:i,cap:j};if(c-e>0)i.thereYet=h,i.cap=k;if(a-d>0)l.thereYet=h,l.cap=k;this.ctx.moveTo(a,c);this.ctx.beginPath();for(var h=a,k=c,j=0,m=!0;!l.thereYet(h,d)||!i.thereYet(k,e);){var n=Math.atan2(e-c,d-a),o=f[j],h=l.cap(d,h+Math.cos(n)*o),k=i.cap(e,k+Math.sin(n)*o);m?this.ctx.lineTo(h,
k):this.ctx.moveTo(h,k);this.ctx.stroke();j=(j+1)%f.length;m=!m}};Pixel.Renderer2D.prototype.drawRect=function(a,c,d,e){c!=void 0?(this.bFill&&this.ctx.fillRect(a,c,d,e),this.bStroke&&this.ctx.strokeRect(a,c,d,e)):(this.bFill&&this.ctx.fillRect(a.x,a.y,a.width,a.height),this.bStroke&&this.ctx.strokeRect(a.x,a.y,a.width,a.height))};Pixel.Renderer2D.prototype.drawSquare=function(a,c,d){this.rectangle(a,c,d,d)};
Pixel.Renderer2D.prototype.drawEllipse=function(a,c,d,e){ox=d/2*0.5522848;oy=e/2*0.5522848;xe=a+d;ye=c+e;xm=a+d/2;ym=c+e/2;this.ctx.beginPath();this.ctx.moveTo(a,ym);this.ctx.bezierCurveTo(a,ym-oy,xm-ox,c,xm,c);this.ctx.bezierCurveTo(xm+ox,c,xe,ym-oy,xe,ym);this.ctx.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye);this.ctx.bezierCurveTo(xm-ox,ye,a,ym+oy,a,ym);this.ctx.closePath();this.bStroke&&this.ctx.stroke();this.bFill&&this.ctx.fill()};
Pixel.Renderer2D.prototype.drawCircle=function(a,c,d){this.ctx.beginPath();this.ctx.arc(a,c,d,0,Math.PI*2,!1);this.bStroke&&this.ctx.stroke();this.bFill&&this.ctx.fill()};Pixel.Renderer2D.prototype.pushMatrix=function(){this.ctx.save()};Pixel.Renderer2D.prototype.popMatrix=function(){this.ctx.restore()};Pixel.Renderer2D.prototype.translate=function(a,c){this.ctx.translate(a,c)};Pixel.Renderer2D.prototype.scale=function(a,c){this.ctx.scale(a,c)};Pixel.Renderer2D.prototype.rotate=function(a){this.ctx.rotate(a)};
Pixel.Renderer2D.prototype.transform=function(a,c,d,e,f,h){this.ctx.transform(a,c,d,e,f,h)};Pixel.Renderer2D.prototype.setTransform=function(a,c,d,e,f,h){this.ctx.setTransform(a,c,d,e,f,h)};Pixel.Renderer2D.prototype.setFont=function(a,c){c==void 0?this.setFont(a.font,a.size):this.ctx.font=c+"pt "+a;this.setTextAlignment(a.alignment);this.setTextBaseline(a.baseline)};Pixel.Renderer2D.prototype.setTextAlignment=function(a){this.ctx.textAlign=a};
Pixel.Renderer2D.prototype.setTextBaseline=function(a){this.ctx.textBaseline=a};Pixel.Renderer2D.prototype.getTextWidth=function(a){return this.ctx.measureText(a).width};Pixel.Renderer2D.prototype.drawText=function(a,c,d){c!=void 0?this.ctx.fillText(a,c,d):(console.log("yea"),this.ctx.fillText(a,this.cursorX,this.cursorY))};Pixel.Renderer2D.prototype.drawTextfield=function(a){this.setFont(a.font);this.useColor(a.color);this.drawText(a.text,a.pos.x,a.pos.y)};
Pixel.Color=function(){this.v=this.l=this.s=this.h=this.b=this.g=this.r=0};Pixel.Color.prototype.set=function(a,c,d,e){if(a!=void 0)this.r=a;if(c!=void 0)this.g=c;if(d!=void 0)this.b=d;this.a=e!=void 0?e:1};Pixel.Color.prototype.setHSL=function(a,c,d,e){if(a!=void 0)this.h=a;if(c!=void 0)this.s=g;if(d!=void 0)this.l=b;this.a=e!=void 0?e:1};Pixel.Color.prototype.setHSV=function(a,c,d,e){if(a!=void 0)this.h=a;if(c!=void 0)this.s=g;if(d!=void 0)this.l=b;if(e!=void 0)this.a=e};
Pixel.Color.prototype.toHSL=function(){var a=Pixel.rgbToHSL(this.r,this.g,this.b);this.setHSL(a.h,a.s,a.l);return a};Pixel.Color.prototype.toHSV=function(){var a=Pixel.rgbToHSV(this.r,this.g,this.b);this.setHSV(a.h,a.s,a.v);return a};Pixel.rgbToHsl=function(a,c,d){a/=255;c/=255;d/=255;var e=Math.max(a,c,d),f=Math.min(a,c,d),h,i=(e+f)/2;if(e==f)h=f=0;else{var j=e-f,f=i>0.5?j/(2-e-f):j/(e+f);switch(e){case a:h=(c-d)/j+(c<d?6:0);break;case c:h=(d-a)/j+2;break;case d:h=(a-c)/j+4}h/=6}return{h:h,s:f,l:i}};
Pixel.hslToRgb=function(a,c,d){a=Pixel.map(a,0,360,0,1);c=Pixel.map(c,0,255,0,1);d=Pixel.map(d,0,255,0,1);if(c==0)d=c=a=d;else var e=function(a,c,d){d<0&&(d+=1);d>1&&(d-=1);return d<1/6?a+(c-a)*6*d:d<0.5?c:d<2/3?a+(c-a)*(2/3-d)*6:a},f=d<0.5?d*(1+c):d+c-d*c,h=2*d-f,d=e(h,f,a+1/3),c=e(h,f,a),a=e(h,f,a-1/3);return{r:d*255,g:c*255,b:a*255}};
Pixel.rgbToHsv=function(a,c,d){a/=255;c/=255;d/=255;var e=Math.max(a,c,d),f=Math.min(a,c,d),h,i=e-f;if(e==f)h=0;else{switch(e){case a:h=(c-d)/i+(c<d?6:0);break;case c:h=(d-a)/i+2;break;case d:h=(a-c)/i+4}h/=6}return{h:h,s:e==0?0:i/e,v:e}};
Pixel.hsvToRgb=function(a,c,d){var a=Pixel.map(a,0,360,0,1),c=Pixel.map(c,0,255,0,1),d=Pixel.map(d,0,255,0,1),e,f,h,i=Math.floor(a*6),j=a*6-i,a=d*(1-c),k=d*(1-j*c),c=d*(1-(1-j)*c);switch(i%6){case 0:e=d;f=c;h=a;break;case 1:e=k;f=d;h=a;break;case 2:e=a;f=d;h=c;break;case 3:e=a;f=k;h=d;break;case 4:e=c;f=a;h=d;break;case 5:e=d,f=a,h=k}return{r:e*255,g:f*255,b:h*255}};
Pixel.Canvas=function(){Pixel.Renderer.call(this);this.canvas=document.createElement("canvas");this.canvas.innerHTML="Your browser does not support HTML5 Canvas.";this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);this.pos={x:0,y:0};cursorY=cursorX=this.height=this.width=0;this.bPixelDoubling=window.devicePixelRatio>=2;this.setSize(50,400);this.setRenderer(this.canvas,Pixel.RENDER_MODE_2D)};Pixel.Canvas.prototype=new Pixel.Renderer;
Pixel.Canvas.prototype.setPos=function(a,c){this.pos.x=a;this.pos.y=c;var d="",d="scale3d("+window.devicePixelRatio+","+window.devicePixelRatio+",0) ";d+="translate3d("+this.pos.x+"px, "+this.pos.y+"px,0px)";this.canvas.style.webkitTransform=d};Pixel.Canvas.prototype.setSize=function(a,c,d){this.width=a;this.height=c;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);d!=void 0&&this.setRenderer(d)};Pixel.Canvas.prototype.getWidth=function(){return this.width};
Pixel.Canvas.prototype.getHeight=function(){return this.height};Pixel.Canvas.prototype.setCursor=function(a,c){this.cursorX=a;this.cursorY=c};Pixel.Object=function(){this.bPressed=this.bInitPressed=!1;this.pos={x:0,y:0};this.radius=this.height=this.width=0;this.shapeMode=Pixel.OBJECT_SHAPE_RECT;this.rect=new Pixel.Rectangle;Pixel.EventDispatcher.call(this)};Pixel.Object.prototype=new Pixel.EventDispatcher;Pixel.Object.prototype.show=function(){};Pixel.Object.prototype.hide=function(){};
Pixel.Object.prototype.setPos=function(a,c){if(Pixel.isSet(a))this.pos.x=a;if(Pixel.isSet(c))this.pos.y=c;this.setRect()};Pixel.Object.prototype.getPos=function(){return this.pos};Pixel.Object.prototype.setSize=function(a,c){if(Pixel.isSet(a))this.width=a;if(Pixel.isSet(c))this.height=c;this.setRect()};Pixel.Object.prototype.setRect=function(){this.rect.set(this.pos.x,this.pos.y,this.width,this.height)};Pixel.Object.prototype.getRect=function(){return this.rect};Pixel.Object.prototype.getWidth=function(){return this.width};
Pixel.Object.prototype.getHeight=function(){return this.height};Pixel.Object.prototype.setShapeMode=function(a){this.shapeMode=a};Pixel.Object.prototype.isPressed=function(){return this.bPressed};
Pixel.Object.prototype.touchStart=function(a){this.setRect(this.pos.x,this.pos.y,this.width,this.height);switch(this.shapeMode){case Pixel.OBJECT_SHAPE_RECT:this.bInitPressed=this.rect.isInside(a.pos.x,a.pos.y);break;case Pixel.OBJECT_SHAPE_CIRCLE:this.bInitPressed=Pixel.dist(this.pos.x,this.pos.y,a.pos.x,a.pos.y)<this.radius*2}return this.bPressed=this.bInitPressed};
Pixel.Object.prototype.touchMoved=function(a){if(this.bInitPressed)switch(this.shapeMode){case Pixel.OBJECT_SHAPE_RECT:this.bPressed=this.rect.isInside(a.pos.x,a.pos.y);break;case Pixel.OBJECT_SHAPE_CIRCLE:this.bPressed=Pixel.dist(this.pos.x,this.post.y,a.pos.x,a.pos.y)<this.radius*2}return this.bPressed};Pixel.Object.prototype.touchEnd=function(){return this.bInitPressed=this.bPressed=!1};Pixel.Image=function(a){Pixel.Object.call(this);a!=void 0&&this.load(a);this.bAllocated=!1};
Pixel.Image.prototype=new Pixel.Object;Pixel.Image.prototype.load=function(a){this.clear();this.image=new Image;var c=this;this.image.addEventListener("load",function(){c.bLoaded=!0;c.setSize(this.width,this.height)});this.image.addEventListener("error",function(){console.log("Could not load image from '"+url+"'")});this.image.src=a};Pixel.Image.prototype.isLoaded=function(){return this.bLoaded};Pixel.Image.prototype.clear=function(){this.bLoaded=!1;this.image=this.imageData=this.pixels=null};
Pixel.Image.prototype.setSize=function(a,c){Pixel.Object.prototype.setSize.call(this,a,c);if(this.bAllocated==!1)this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.imageData=this.ctx.getImageData(0,0,this.getWidth(),this.getHeight());this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height)};Pixel.Image.prototype.getImageData=function(){return this.imageData};
Pixel.Image.prototype.getPixels=function(){return this.bLoaded?(this.ctx.drawImage(this.image,0,0),this.imageData=this.ctx.getImageData(0,0,this.size.width,this.size.height),this.pixels=this.imageData.data):null};
Pixel.Image.prototype.setFromPixels=function(a,c,d){this.clear();this.setSize(c,d);this.imageData=this.ctx.getImageData(0,0,this.size.width,this.size.height);this.pixels=this.imageData.data;for(c=a.length;c--;)this.pixels[c]=a[c];this.ctx.putImageData(this.imageData,0,0);this.image=new Element("img");this.image.addEvent("load",function(){this.image.removeEvent("load");this.bLoaded=!0}.bind(this));this.image.src=this.canvas.toDataURL("image/png")};Pixel.FontSizeCvs=null;
Pixel.Font=function(a,c,d,e){this.font=a||"Arial";this.size=c||12;this.alignment=d||Pixel.TEXT_BASELINE_LEFT;this.baseline=e||Pixel.TEXT_BASELINE_TOP;if(Pixel.FontSizeCvs==null)Pixel.FontSizeCvs=new Pixel.Canvas(Pixel.RENDER_MODE_2D)};Pixel.Font.prototype.setSize=function(a){this.size=a};Pixel.Font.prototype.setFont=function(a){this.font=a};Pixel.Font.prototype.setSize=function(a){this.size=a};Pixel.Font.prototype.setFont=function(a){this.font=a};
Pixel.Font.prototype.setAlignment=function(a){this.alignment=a};Pixel.Font.prototype.setBaseline=function(a){this.baseline=a};Pixel.Font.prototype.getSize=function(){return this.size};Pixel.Font.prototype.getTextWidth=function(a){Pixel.FontSizeCvs.setFont(this);return Pixel.FontSizeCvs.getTextWidth(a)};Pixel.Font.prototype.getTextHeight=function(){return Math.round(this.size*1.5)};
Pixel.Textfield=function(a,c){Pixel.Object.call(this);this.font=c||new Pixel.Font("Arial",14);this.color=new Pixel.Color(255,255,255,1);this.text=a||"Text not set";this.setText(this.text)};Pixel.Textfield.prototype=new Pixel.Object;Pixel.Textfield.prototype.setFont=function(a,c,d,e){this.font=c!=void 0?new Pixel.Font(a,c,d,e):a};Pixel.Textfield.prototype.setColor=function(a,c,d,e){this.color.set(a,c,d,e)};
Pixel.Textfield.prototype.setText=function(a){this.text=a;this.width=this.font.getTextWidth(this.text);this.height=this.font.getTextHeight(this.text);this.setRect()};
Pixel.Textfield.prototype.setRect=function(){switch(this.font.alignment){case Pixel.TEXT_ALIGN_LEFT:switch(this.font.baseline){case Pixel.TEXT_BASELINE_TOP:this.rect.set(this.pos.x,this.pos.y,this.width,this.height);break;case Pixel.TEXT_BASELINE_MIDDLE:this.rect.set(this.pos.x,this.pos.y-this.height/2,this.width,this.height);break;case Pixel.TEXT_BASELINE_BOTTOM:this.rect.set(this.pos.x,this.pos.y-this.height,this.width,this.height)}break;case Pixel.TEXT_ALIGN_CENTER:switch(this.font.baseline){case Pixel.TEXT_BASELINE_TOP:this.rect.set(this.pos.x-
this.width/2,this.pos.y,this.width,this.height);break;case Pixel.TEXT_BASELINE_MIDDLE:this.rect.set(this.pos.x-this.width/2,this.pos.y-this.height/2,this.width,this.height);break;case Pixel.TEXT_BASELINE_BOTTOM:this.rect.set(this.pos.x-this.width/2,this.pos.y-this.height,this.width,this.height)}break;case Pixel.TEXT_ALIGN_RIGHT:switch(this.font.baseline){case Pixel.TEXT_BASELINE_TOP:this.rect.set(this.pos.x-this.width,this.pos.y,this.width,this.height);break;case Pixel.TEXT_BASELINE_MIDDLE:this.rect.set(this.pos.x-
this.width,this.pos.y-this.height/2,this.width,this.height);break;case Pixel.TEXT_BASELINE_BOTTOM:this.rect.set(this.pos.x-this.width,this.pos.y-this.height,this.width,this.height)}}};
Pixel.App=function(){this.bSetup=!1;this.bRunning=!0;this.bIsMobileApp=!1;this.fps=60;this.curFPS=0;this.bShowFPS=!1;this.nFPSSamples=50;this.fpsSamples=[];this.curFpsSample=-1;this.curFps=0;this.fpsFont=new Pixel.Font("Verdana",10,Pixel.TEXT_ALIGN_LEFT);this.prevTime=this.startTime=0;this.prevTime=this.startTime=(new Date).getTime();this.fpsFont=new Pixel.Font("Verdana",10,Pixel.TEXT_ALIGN_LEFT);var a=this;Pixel.isTouchDevice()?(this.canvas.addEventListener("touchstart",function(c){a.touchStartListener.call(a,
c)},!1),this.canvas.addEventListener("touchmove",function(c){a.touchMovedListener.call(a,c)},!1),this.canvas.addEventListener("touchend",function(c){a.touchEndListener.call(a,c)},!1)):(this.canvas.addEventListener("mousedown",function(c){a.mouseDownListener.call(a,c)},!1),this.canvas.addEventListener("mousemove",function(c){a.mouseMovedListener.call(a,c)},!1),this.canvas.addEventListener("mouseup",function(c){a.mouseUpListener.call(a,c)},!1))};Pixel.App.prototype=new Pixel.Canvas;
Pixel.App.prototype.start=function(){this.bRunning=!0};Pixel.App.prototype.stop=function(){this.bRunning=!1};Pixel.App.prototype.setup=function(){};Pixel.App.prototype.update=function(){};Pixel.App.prototype.draw=function(){};Pixel.App.prototype.run=function(){if(this.bRunning){if(this.setup!=void 0&&this.bSetup==!1)this.setup(),this.bSetup=!0;this.update();this.draw();this.bShowFPS&&(this.updateFPS(),this.drawFPS());window.requestAnimFrame(this.run.bind(this))}};
Pixel.App.prototype.setFPS=function(a){this.fps=a};Pixel.App.prototype.getFPS=function(){return this.fps};Pixel.App.prototype.showFPS=function(){for(var a=0;a<this.fpsSamples.length;a++)this.fpsSamples[a]=0;this.bShowFPS=!0};Pixel.App.prototype.hideFPS=function(){this.bShowFPS=!1};
Pixel.App.prototype.updateFPS=function(){this.curFpsSample++;if(this.curFpsSample>=this.nFPSSamples)this.curFpsSample=0;var a=this.getElapsedTime();this.fpsSamples[this.curFpsSample]=1E3/(a-this.prevTime);for(var c=0,d=0;d<this.fpsSamples.length;d++)c+=this.fpsSamples[d];c/=this.fpsSamples.length;this.curFps=Math.floor(c);this.prevTime=a};
Pixel.App.prototype.drawFPS=function(){this.setFont(this.fpsFont);this.setColor(0,0,0);this.drawText("FPS: "+this.curFps.toFixed(2),20,20);this.setColor(255,255,2550);this.drawText("FPS: "+this.curFps.toFixed(2),22,22)};Pixel.App.prototype.getElapsedTime=function(){return(new Date).getTime()-this.startTime};Pixel.App.prototype.touches=[];
Pixel.App.prototype.touchStartListener=function(a){if(this.touchStart!=void 0)for(var c=0;c<a.changedTouches.length;c++){for(var d=null,e=0;e<this.touches.length;e++)if(this.touches[e]==null){d=e;break}if(d==null)d=this.touches.length;this.touches[d]={id:e,pos:{x:(!this.bPixelDoubling?a.changedTouches[c].pageX:a.changedTouches[c].pageX/2)-this.pos.x,y:(!this.bPixelDoubling?a.changedTouches[c].pageY:a.changedTouches[c].pageY/2)-this.pos.y},uniqueID:a.changedTouches[c].identifier};this.dispatch("touch start",
this.touches[d])}};
Pixel.App.prototype.touchMovedListener=function(a){if(this.touchMoved!=void 0)for(var c=0;c<a.changedTouches.length;c++)for(var d=a.changedTouches[c].identifier,e=0;e<this.touches.length;e++)if(this.touches[e]!=null&&d==this.touches[e].uniqueID){this.touches[e].pos={x:(!this.bPixelDoubling?a.changedTouches[c].pageX:a.changedTouches[c].pageX/2)-this.pos.x,y:(!this.bPixelDoubling?a.changedTouches[c].pageY:a.changedTouches[c].pageY/2)-this.pos.y};this.dispatch("touch moved",this.touches[e]);break}};
Pixel.App.prototype.touchEndListener=function(a){if(this.touchEnd!=void 0)for(var c=0;c<a.changedTouches.length;c++)for(var d=a.changedTouches[c].identifier,e=0;e<this.touches.length;e++)if(this.touches[e]!=null&&d==this.touches[e].uniqueID){this.dispatch("touchend",this.touches[e]);this.touches[e]=null;break}};Pixel.App.prototype.bMouseDown=!1;
Pixel.App.prototype.mouseDownListener=function(a){this.bMouseDown=!0;a=Pixel.getRelativeMouseCoords(a,this.canvas);this.bIsMobileApp?this.touchStart!=void 0&&this.dispatch("touchstart",{id:0,position:a}):this.dispatch("mousedown",a)};Pixel.App.prototype.mouseMovedListener=function(a){this.bMouseDown&&this.mouseDraggedListener(a);a=Pixel.getRelativeMouseCoords(a,this.canvas);this.bIsMobileApp?this.dispatch("touchmoved",{id:0,position:a}):this.dispatch("mousemoved",a)};
Pixel.App.prototype.mouseUpListener=function(a){this.bMouseDown=!1;a=Pixel.getRelativeMouseCoords(a,this.canvas);this.bIsMobileApp?this.dispatch("touchend",{id:0,position:a}):this.dispatch("mouseup",a)};Pixel.App.prototype.mouseDraggedListener=function(){};
