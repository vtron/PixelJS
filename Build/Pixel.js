"undefined"==typeof Pixel?(Pixel={version:"0.1"},"undefined"==typeof px&&(px=Pixel)):console.log("Pixel Namespace Already Exists!");
(function(){var a;"undefined"==typeof exports?"function"==typeof define&&"object"==typeof define.amd&&define.amd?(a={},define(function(){return a})):a=window:a=exports;(function(a){if(!e)var e=1E-6;if(!f)var f="undefined"!=typeof Float32Array?Float32Array:Array;var h={setMatrixArrayType:function(d){f=d}};"undefined"!=typeof a&&(a.glMatrix=h);var k={create:function(){var d=new f(2);return d[0]=0,d[1]=0,d},clone:function(d){var l=new f(2);return l[0]=d[0],l[1]=d[1],l},fromValues:function(d,l){var a=
new f(2);return a[0]=d,a[1]=l,a},copy:function(d,l){return d[0]=l[0],d[1]=l[1],d},set:function(d,l,a){return d[0]=l,d[1]=a,d},add:function(d,l,a){return d[0]=l[0]+a[0],d[1]=l[1]+a[1],d},subtract:function(d,l,a){return d[0]=l[0]-a[0],d[1]=l[1]-a[1],d}};k.sub=k.subtract;k.multiply=function(d,l,a){return d[0]=l[0]*a[0],d[1]=l[1]*a[1],d};k.mul=k.multiply;k.divide=function(d,l,a){return d[0]=l[0]/a[0],d[1]=l[1]/a[1],d};k.div=k.divide;k.min=function(d,l,a){return d[0]=Math.min(l[0],a[0]),d[1]=Math.min(l[1],
a[1]),d};k.max=function(d,l,a){return d[0]=Math.max(l[0],a[0]),d[1]=Math.max(l[1],a[1]),d};k.scale=function(d,l,a){return d[0]=l[0]*a,d[1]=l[1]*a,d};k.distance=function(d,l){var a=l[0]-d[0],c=l[1]-d[1];return Math.sqrt(a*a+c*c)};k.dist=k.distance;k.squaredDistance=function(d,l){var a=l[0]-d[0],c=l[1]-d[1];return a*a+c*c};k.sqrDist=k.squaredDistance;k.length=function(d){var l=d[0];d=d[1];return Math.sqrt(l*l+d*d)};k.len=k.length;k.squaredLength=function(d){var l=d[0];d=d[1];return l*l+d*d};k.sqrLen=
k.squaredLength;k.negate=function(d,l){return d[0]=-l[0],d[1]=-l[1],d};k.normalize=function(d,l){var a=l[0],c=l[1],a=a*a+c*c;return 0<a&&(a=1/Math.sqrt(a),d[0]=l[0]*a,d[1]=l[1]*a),d};k.dot=function(d,l){return d[0]*l[0]+d[1]*l[1]};k.cross=function(d,l,a){l=l[0]*a[1]-l[1]*a[0];return d[0]=d[1]=0,d[2]=l,d};k.lerp=function(d,l,a,c){var e=l[0];l=l[1];return d[0]=e+c*(a[0]-e),d[1]=l+c*(a[1]-l),d};k.transformMat2=function(d,l,a){var c=l[0];l=l[1];return d[0]=c*a[0]+l*a[1],d[1]=c*a[2]+l*a[3],d};k.forEach=
function(){var d=k.create();return function(l,a,c,e,q,f){var h;a||(a=2);c||(c=0);for(e?h=Math.min(e*a+c,l.length):h=l.length;c<h;c+=a)d[0]=l[c],d[1]=l[c+1],q(d,d,f),l[c]=d[0],l[c+1]=d[1];return l}}();k.str=function(d){return"vec2("+d[0]+", "+d[1]+")"};"undefined"!=typeof a&&(a.vec2=k);var n={create:function(){var d=new f(3);return d[0]=0,d[1]=0,d[2]=0,d},clone:function(d){var l=new f(3);return l[0]=d[0],l[1]=d[1],l[2]=d[2],l},fromValues:function(d,l,a){var c=new f(3);return c[0]=d,c[1]=l,c[2]=a,c},
copy:function(d,l){return d[0]=l[0],d[1]=l[1],d[2]=l[2],d},set:function(d,l,a,c){return d[0]=l,d[1]=a,d[2]=c,d},add:function(d,l,a){return d[0]=l[0]+a[0],d[1]=l[1]+a[1],d[2]=l[2]+a[2],d},subtract:function(d,l,a){return d[0]=l[0]-a[0],d[1]=l[1]-a[1],d[2]=l[2]-a[2],d}};n.sub=n.subtract;n.multiply=function(d,l,a){return d[0]=l[0]*a[0],d[1]=l[1]*a[1],d[2]=l[2]*a[2],d};n.mul=n.multiply;n.divide=function(d,l,a){return d[0]=l[0]/a[0],d[1]=l[1]/a[1],d[2]=l[2]/a[2],d};n.div=n.divide;n.min=function(d,l,a){return d[0]=
Math.min(l[0],a[0]),d[1]=Math.min(l[1],a[1]),d[2]=Math.min(l[2],a[2]),d};n.max=function(d,l,a){return d[0]=Math.max(l[0],a[0]),d[1]=Math.max(l[1],a[1]),d[2]=Math.max(l[2],a[2]),d};n.scale=function(d,l,a){return d[0]=l[0]*a,d[1]=l[1]*a,d[2]=l[2]*a,d};n.distance=function(d,l){var a=l[0]-d[0],c=l[1]-d[1],e=l[2]-d[2];return Math.sqrt(a*a+c*c+e*e)};n.dist=n.distance;n.squaredDistance=function(d,l){var a=l[0]-d[0],c=l[1]-d[1],e=l[2]-d[2];return a*a+c*c+e*e};n.sqrDist=n.squaredDistance;n.length=function(d){var l=
d[0],a=d[1];d=d[2];return Math.sqrt(l*l+a*a+d*d)};n.len=n.length;n.squaredLength=function(d){var l=d[0],a=d[1];d=d[2];return l*l+a*a+d*d};n.sqrLen=n.squaredLength;n.negate=function(d,l){return d[0]=-l[0],d[1]=-l[1],d[2]=-l[2],d};n.normalize=function(d,l){var a=l[0],c=l[1],e=l[2],a=a*a+c*c+e*e;return 0<a&&(a=1/Math.sqrt(a),d[0]=l[0]*a,d[1]=l[1]*a,d[2]=l[2]*a),d};n.dot=function(d,l){return d[0]*l[0]+d[1]*l[1]+d[2]*l[2]};n.cross=function(d,l,a){var c=l[0],e=l[1];l=l[2];var q=a[0],f=a[1];a=a[2];return d[0]=
e*a-l*f,d[1]=l*q-c*a,d[2]=c*f-e*q,d};n.lerp=function(d,l,a,c){var e=l[0],q=l[1];l=l[2];return d[0]=e+c*(a[0]-e),d[1]=q+c*(a[1]-q),d[2]=l+c*(a[2]-l),d};n.transformMat4=function(d,l,a){var c=l[0],e=l[1];l=l[2];return d[0]=a[0]*c+a[4]*e+a[8]*l+a[12],d[1]=a[1]*c+a[5]*e+a[9]*l+a[13],d[2]=a[2]*c+a[6]*e+a[10]*l+a[14],d};n.transformQuat=function(d,l,a){var c=l[0],e=l[1],q=l[2];l=a[0];var f=a[1],h=a[2];a=a[3];var s=a*c+f*q-h*e,v=a*e+h*c-l*q,k=a*q+l*e-f*c,c=-l*c-f*e-h*q;return d[0]=s*a+c*-l+v*-h-k*-f,d[1]=
v*a+c*-f+k*-l-s*-h,d[2]=k*a+c*-h+s*-f-v*-l,d};n.forEach=function(){var d=n.create();return function(l,a,c,e,q,f){var h;a||(a=3);c||(c=0);for(e?h=Math.min(e*a+c,l.length):h=l.length;c<h;c+=a)d[0]=l[c],d[1]=l[c+1],d[2]=l[c+2],q(d,d,f),l[c]=d[0],l[c+1]=d[1],l[c+2]=d[2];return l}}();n.str=function(d){return"vec3("+d[0]+", "+d[1]+", "+d[2]+")"};"undefined"!=typeof a&&(a.vec3=n);var m={create:function(){var d=new f(4);return d[0]=0,d[1]=0,d[2]=0,d[3]=0,d},clone:function(d){var l=new f(4);return l[0]=d[0],
l[1]=d[1],l[2]=d[2],l[3]=d[3],l},fromValues:function(d,l,a,c){var e=new f(4);return e[0]=d,e[1]=l,e[2]=a,e[3]=c,e},copy:function(d,l){return d[0]=l[0],d[1]=l[1],d[2]=l[2],d[3]=l[3],d},set:function(d,l,a,c,e){return d[0]=l,d[1]=a,d[2]=c,d[3]=e,d},add:function(d,l,a){return d[0]=l[0]+a[0],d[1]=l[1]+a[1],d[2]=l[2]+a[2],d[3]=l[3]+a[3],d},subtract:function(d,a,c){return d[0]=a[0]-c[0],d[1]=a[1]-c[1],d[2]=a[2]-c[2],d[3]=a[3]-c[3],d}};m.sub=m.subtract;m.multiply=function(d,a,c){return d[0]=a[0]*c[0],d[1]=
a[1]*c[1],d[2]=a[2]*c[2],d[3]=a[3]*c[3],d};m.mul=m.multiply;m.divide=function(d,a,c){return d[0]=a[0]/c[0],d[1]=a[1]/c[1],d[2]=a[2]/c[2],d[3]=a[3]/c[3],d};m.div=m.divide;m.min=function(d,a,c){return d[0]=Math.min(a[0],c[0]),d[1]=Math.min(a[1],c[1]),d[2]=Math.min(a[2],c[2]),d[3]=Math.min(a[3],c[3]),d};m.max=function(d,a,c){return d[0]=Math.max(a[0],c[0]),d[1]=Math.max(a[1],c[1]),d[2]=Math.max(a[2],c[2]),d[3]=Math.max(a[3],c[3]),d};m.scale=function(d,a,c){return d[0]=a[0]*c,d[1]=a[1]*c,d[2]=a[2]*c,
d[3]=a[3]*c,d};m.distance=function(d,a){var c=a[0]-d[0],e=a[1]-d[1],S=a[2]-d[2],f=a[3]-d[3];return Math.sqrt(c*c+e*e+S*S+f*f)};m.dist=m.distance;m.squaredDistance=function(d,a){var c=a[0]-d[0],e=a[1]-d[1],f=a[2]-d[2],q=a[3]-d[3];return c*c+e*e+f*f+q*q};m.sqrDist=m.squaredDistance;m.length=function(d){var a=d[0],c=d[1],e=d[2];d=d[3];return Math.sqrt(a*a+c*c+e*e+d*d)};m.len=m.length;m.squaredLength=function(d){var a=d[0],c=d[1],e=d[2];d=d[3];return a*a+c*c+e*e+d*d};m.sqrLen=m.squaredLength;m.negate=
function(d,a){return d[0]=-a[0],d[1]=-a[1],d[2]=-a[2],d[3]=-a[3],d};m.normalize=function(d,a){var c=a[0],e=a[1],f=a[2],q=a[3],c=c*c+e*e+f*f+q*q;return 0<c&&(c=1/Math.sqrt(c),d[0]=a[0]*c,d[1]=a[1]*c,d[2]=a[2]*c,d[3]=a[3]*c),d};m.dot=function(d,a){return d[0]*a[0]+d[1]*a[1]+d[2]*a[2]+d[3]*a[3]};m.lerp=function(d,a,c,e){var f=a[0],q=a[1],h=a[2];a=a[3];return d[0]=f+e*(c[0]-f),d[1]=q+e*(c[1]-q),d[2]=h+e*(c[2]-h),d[3]=a+e*(c[3]-a),d};m.transformMat4=function(d,a,c){var e=a[0],f=a[1],q=a[2];a=a[3];return d[0]=
c[0]*e+c[4]*f+c[8]*q+c[12]*a,d[1]=c[1]*e+c[5]*f+c[9]*q+c[13]*a,d[2]=c[2]*e+c[6]*f+c[10]*q+c[14]*a,d[3]=c[3]*e+c[7]*f+c[11]*q+c[15]*a,d};m.transformQuat=function(d,a,c){var e=a[0],f=a[1],q=a[2];a=c[0];var h=c[1],G=c[2];c=c[3];var s=c*e+h*q-G*f,k=c*f+G*e-a*q,w=c*q+a*f-h*e,e=-a*e-h*f-G*q;return d[0]=s*c+e*-a+k*-G-w*-h,d[1]=k*c+e*-h+w*-a-s*-G,d[2]=w*c+e*-G+s*-h-k*-a,d};m.forEach=function(){var d=m.create();return function(a,c,e,f,h,r){var G;c||(c=4);e||(e=0);for(f?G=Math.min(f*c+e,a.length):G=a.length;e<
G;e+=c)d[0]=a[e],d[1]=a[e+1],d[2]=a[e+2],d[3]=a[e+3],h(d,d,r),a[e]=d[0],a[e+1]=d[1],a[e+2]=d[2],a[e+3]=d[3];return a}}();m.str=function(d){return"vec4("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+")"};"undefined"!=typeof a&&(a.vec4=m);h={};new Float32Array([1,0,0,1]);h.create=function(){var d=new f(4);return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d};h.clone=function(d){var a=new f(4);return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a};h.copy=function(d,a){return d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],d};h.identity=function(d){return d[0]=
1,d[1]=0,d[2]=0,d[3]=1,d};h.transpose=function(d,a){if(d===a){var c=a[1];d[1]=a[2];d[2]=c}else d[0]=a[0],d[1]=a[2],d[2]=a[1],d[3]=a[3];return d};h.invert=function(d,a){var c=a[0],e=a[1],f=a[2],h=a[3],r=c*h-f*e;return r?(r=1/r,d[0]=h*r,d[1]=-e*r,d[2]=-f*r,d[3]=c*r,d):null};h.adjoint=function(d,a){var c=a[0];return d[0]=a[3],d[1]=-a[1],d[2]=-a[2],d[3]=c,d};h.determinant=function(d){return d[0]*d[3]-d[2]*d[1]};h.multiply=function(d,a,c){var e=a[0],f=a[1],h=a[2];a=a[3];var r=c[0],G=c[1],s=c[2];c=c[3];
return d[0]=e*r+f*s,d[1]=e*G+f*c,d[2]=h*r+a*s,d[3]=h*G+a*c,d};h.mul=h.multiply;h.rotate=function(d,a,c){var e=a[0],f=a[1],h=a[2];a=a[3];var r=Math.sin(c);c=Math.cos(c);return d[0]=e*c+f*r,d[1]=e*-r+f*c,d[2]=h*c+a*r,d[3]=h*-r+a*c,d};h.scale=function(d,a,c){var e=a[1],f=a[2],h=a[3],r=c[0];c=c[1];return d[0]=a[0]*r,d[1]=e*c,d[2]=f*r,d[3]=h*c,d};h.str=function(d){return"mat2("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+")"};"undefined"!=typeof a&&(a.mat2=h);h={};new Float32Array([1,0,0,0,1,0,0,0,1]);h.create=
function(){var d=new f(9);return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d};h.clone=function(d){var a=new f(9);return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[8]=d[8],a};h.copy=function(d,a){return d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],d[4]=a[4],d[5]=a[5],d[6]=a[6],d[7]=a[7],d[8]=a[8],d};h.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d};h.transpose=function(d,a){if(d===a){var c=a[1],e=a[2],
f=a[5];d[1]=a[3];d[2]=a[6];d[3]=c;d[5]=a[7];d[6]=e;d[7]=f}else d[0]=a[0],d[1]=a[3],d[2]=a[6],d[3]=a[1],d[4]=a[4],d[5]=a[7],d[6]=a[2],d[7]=a[5],d[8]=a[8];return d};h.invert=function(d,a){var c=a[0],e=a[1],f=a[2],h=a[3],r=a[4],G=a[5],s=a[6],k=a[7],w=a[8],t=w*r-G*k,m=-w*h+G*s,u=k*h-r*s,x=c*t+e*m+f*u;return x?(x=1/x,d[0]=t*x,d[1]=(-w*e+f*k)*x,d[2]=(G*e-f*r)*x,d[3]=m*x,d[4]=(w*c-f*s)*x,d[5]=(-G*c+f*h)*x,d[6]=u*x,d[7]=(-k*c+e*s)*x,d[8]=(r*c-e*h)*x,d):null};h.adjoint=function(d,a){var c=a[0],e=a[1],f=a[2],
h=a[3],r=a[4],k=a[5],s=a[6],v=a[7],w=a[8];return d[0]=r*w-k*v,d[1]=f*v-e*w,d[2]=e*k-f*r,d[3]=k*s-h*w,d[4]=c*w-f*s,d[5]=f*h-c*k,d[6]=h*v-r*s,d[7]=e*s-c*v,d[8]=c*r-e*h,d};h.determinant=function(d){var a=d[3],c=d[4],e=d[5],f=d[6],h=d[7],r=d[8];return d[0]*(r*c-e*h)+d[1]*(-r*a+e*f)+d[2]*(h*a-c*f)};h.multiply=function(d,a,c){var e=a[0],f=a[1],h=a[2],r=a[3],k=a[4],s=a[5],v=a[6],w=a[7];a=a[8];var t=c[0],m=c[1],u=c[2],x=c[3],n=c[4],p=c[5],A=c[6],B=c[7];c=c[8];return d[0]=t*e+m*r+u*v,d[1]=t*f+m*k+u*w,d[2]=
t*h+m*s+u*a,d[3]=x*e+n*r+p*v,d[4]=x*f+n*k+p*w,d[5]=x*h+n*s+p*a,d[6]=A*e+B*r+c*v,d[7]=A*f+B*k+c*w,d[8]=A*h+B*s+c*a,d};h.mul=h.multiply;h.str=function(d){return"mat3("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+", "+d[6]+", "+d[7]+", "+d[8]+")"};"undefined"!=typeof a&&(a.mat3=h);var p={};new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);p.create=function(){var d=new f(16);return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=
0,d[15]=1,d};p.clone=function(d){var a=new f(16);return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[8]=d[8],a[9]=d[9],a[10]=d[10],a[11]=d[11],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15],a};p.copy=function(d,a){return d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],d[4]=a[4],d[5]=a[5],d[6]=a[6],d[7]=a[7],d[8]=a[8],d[9]=a[9],d[10]=a[10],d[11]=a[11],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15],d};p.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=
1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a};p.transpose=function(a,c){if(a===c){var e=c[1],f=c[2],h=c[3],q=c[6],r=c[7],k=c[11];a[1]=c[4];a[2]=c[8];a[3]=c[12];a[4]=e;a[6]=c[9];a[7]=c[13];a[8]=f;a[9]=q;a[11]=c[14];a[12]=h;a[13]=r;a[14]=k}else a[0]=c[0],a[1]=c[4],a[2]=c[8],a[3]=c[12],a[4]=c[1],a[5]=c[5],a[6]=c[9],a[7]=c[13],a[8]=c[2],a[9]=c[6],a[10]=c[10],a[11]=c[14],a[12]=c[3],a[13]=c[7],a[14]=c[11],a[15]=c[15];return a};p.invert=function(a,c){var e=c[0],f=c[1],
h=c[2],q=c[3],r=c[4],k=c[5],s=c[6],v=c[7],w=c[8],t=c[9],m=c[10],u=c[11],n=c[12],p=c[13],z=c[14],A=c[15],B=e*k-f*r,C=e*s-h*r,D=e*v-q*r,E=f*s-h*k,I=f*v-q*k,J=h*v-q*s,K=w*p-t*n,L=w*z-m*n,M=w*A-u*n,N=t*z-m*p,O=t*A-u*p,P=m*A-u*z,H=B*P-C*O+D*N+E*M-I*L+J*K;return H?(H=1/H,a[0]=(k*P-s*O+v*N)*H,a[1]=(h*O-f*P-q*N)*H,a[2]=(p*J-z*I+A*E)*H,a[3]=(m*I-t*J-u*E)*H,a[4]=(s*M-r*P-v*L)*H,a[5]=(e*P-h*M+q*L)*H,a[6]=(z*D-n*J-A*C)*H,a[7]=(w*J-m*D+u*C)*H,a[8]=(r*O-k*M+v*K)*H,a[9]=(f*M-e*O-q*K)*H,a[10]=(n*I-p*D+A*B)*H,a[11]=
(t*D-w*I-u*B)*H,a[12]=(k*L-r*N-s*K)*H,a[13]=(e*N-f*L+h*K)*H,a[14]=(p*C-n*E-z*B)*H,a[15]=(w*E-t*C+m*B)*H,a):null};p.adjoint=function(a,c){var e=c[0],f=c[1],h=c[2],q=c[3],r=c[4],k=c[5],s=c[6],v=c[7],m=c[8],t=c[9],n=c[10],u=c[11],p=c[12],y=c[13],z=c[14],A=c[15];return a[0]=k*(n*A-u*z)-t*(s*A-v*z)+y*(s*u-v*n),a[1]=-(f*(n*A-u*z)-t*(h*A-q*z)+y*(h*u-q*n)),a[2]=f*(s*A-v*z)-k*(h*A-q*z)+y*(h*v-q*s),a[3]=-(f*(s*u-v*n)-k*(h*u-q*n)+t*(h*v-q*s)),a[4]=-(r*(n*A-u*z)-m*(s*A-v*z)+p*(s*u-v*n)),a[5]=e*(n*A-u*z)-m*(h*
A-q*z)+p*(h*u-q*n),a[6]=-(e*(s*A-v*z)-r*(h*A-q*z)+p*(h*v-q*s)),a[7]=e*(s*u-v*n)-r*(h*u-q*n)+m*(h*v-q*s),a[8]=r*(t*A-u*y)-m*(k*A-v*y)+p*(k*u-v*t),a[9]=-(e*(t*A-u*y)-m*(f*A-q*y)+p*(f*u-q*t)),a[10]=e*(k*A-v*y)-r*(f*A-q*y)+p*(f*v-q*k),a[11]=-(e*(k*u-v*t)-r*(f*u-q*t)+m*(f*v-q*k)),a[12]=-(r*(t*z-n*y)-m*(k*z-s*y)+p*(k*n-s*t)),a[13]=e*(t*z-n*y)-m*(f*z-h*y)+p*(f*n-h*t),a[14]=-(e*(k*z-s*y)-r*(f*z-h*y)+p*(f*s-h*k)),a[15]=e*(k*n-s*t)-r*(f*n-h*t)+m*(f*s-h*k),a};p.determinant=function(a){var c=a[0],e=a[1],f=a[2],
h=a[3],q=a[4],k=a[5],n=a[6],s=a[7],v=a[8],m=a[9],t=a[10],p=a[11],u=a[12],x=a[13],y=a[14];a=a[15];return(c*k-e*q)*(t*a-p*y)-(c*n-f*q)*(m*a-p*x)+(c*s-h*q)*(m*y-t*x)+(e*n-f*k)*(v*a-p*u)-(e*s-h*k)*(v*y-t*u)+(f*s-h*n)*(v*x-m*u)};p.multiply=function(a,c,e){var f=c[0],h=c[1],q=c[2],k=c[3],n=c[4],s=c[5],m=c[6],p=c[7],t=c[8],F=c[9],u=c[10],x=c[11],y=c[12],z=c[13],A=c[14];c=c[15];var B=e[0],C=e[1],D=e[2],E=e[3];return a[0]=B*f+C*n+D*t+E*y,a[1]=B*h+C*s+D*F+E*z,a[2]=B*q+C*m+D*u+E*A,a[3]=B*k+C*p+D*x+E*c,B=e[4],
C=e[5],D=e[6],E=e[7],a[4]=B*f+C*n+D*t+E*y,a[5]=B*h+C*s+D*F+E*z,a[6]=B*q+C*m+D*u+E*A,a[7]=B*k+C*p+D*x+E*c,B=e[8],C=e[9],D=e[10],E=e[11],a[8]=B*f+C*n+D*t+E*y,a[9]=B*h+C*s+D*F+E*z,a[10]=B*q+C*m+D*u+E*A,a[11]=B*k+C*p+D*x+E*c,B=e[12],C=e[13],D=e[14],E=e[15],a[12]=B*f+C*n+D*t+E*y,a[13]=B*h+C*s+D*F+E*z,a[14]=B*q+C*m+D*u+E*A,a[15]=B*k+C*p+D*x+E*c,a};p.mul=p.multiply;p.translate=function(a,c,e){var f=e[0],h=e[1];e=e[2];var q,k,n,s,m,p,t,F,u,x,y,z;return c===a?(a[12]=c[0]*f+c[4]*h+c[8]*e+c[12],a[13]=c[1]*f+
c[5]*h+c[9]*e+c[13],a[14]=c[2]*f+c[6]*h+c[10]*e+c[14],a[15]=c[3]*f+c[7]*h+c[11]*e+c[15]):(q=c[0],k=c[1],n=c[2],s=c[3],m=c[4],p=c[5],t=c[6],F=c[7],u=c[8],x=c[9],y=c[10],z=c[11],a[0]=q,a[1]=k,a[2]=n,a[3]=s,a[4]=m,a[5]=p,a[6]=t,a[7]=F,a[8]=u,a[9]=x,a[10]=y,a[11]=z,a[12]=q*f+m*h+u*e+c[12],a[13]=k*f+p*h+x*e+c[13],a[14]=n*f+t*h+y*e+c[14],a[15]=s*f+F*h+z*e+c[15]),a};p.scale=function(a,c,e){var f=e[0],h=e[1];e=e[2];return a[0]=c[0]*f,a[1]=c[1]*f,a[2]=c[2]*f,a[3]=c[3]*f,a[4]=c[4]*h,a[5]=c[5]*h,a[6]=c[6]*h,
a[7]=c[7]*h,a[8]=c[8]*e,a[9]=c[9]*e,a[10]=c[10]*e,a[11]=c[11]*e,a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15],a};p.rotate=function(a,c,f,h){var k=h[0],q=h[1];h=h[2];var r=Math.sqrt(k*k+q*q+h*h),n,s,m,p,t,F,u,x,y,z,A,B,C,D,E,I,J,K,L,M,N,O,P,H;return Math.abs(r)<e?null:(r=1/r,k*=r,q*=r,h*=r,n=Math.sin(f),s=Math.cos(f),m=1-s,p=c[0],t=c[1],F=c[2],u=c[3],x=c[4],y=c[5],z=c[6],A=c[7],B=c[8],C=c[9],D=c[10],E=c[11],I=k*k*m+s,J=q*k*m+h*n,K=h*k*m-q*n,L=k*q*m-h*n,M=q*q*m+s,N=h*q*m+k*n,O=k*h*m+q*n,P=q*h*m-k*
n,H=h*h*m+s,a[0]=p*I+x*J+B*K,a[1]=t*I+y*J+C*K,a[2]=F*I+z*J+D*K,a[3]=u*I+A*J+E*K,a[4]=p*L+x*M+B*N,a[5]=t*L+y*M+C*N,a[6]=F*L+z*M+D*N,a[7]=u*L+A*M+E*N,a[8]=p*O+x*P+B*H,a[9]=t*O+y*P+C*H,a[10]=F*O+z*P+D*H,a[11]=u*O+A*P+E*H,c!==a&&(a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]),a)};p.rotateX=function(a,c,e){var f=Math.sin(e);e=Math.cos(e);var h=c[4],k=c[5],r=c[6],m=c[7],n=c[8],p=c[9],w=c[10],t=c[11];return c!==a&&(a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]),
a[4]=h*e+n*f,a[5]=k*e+p*f,a[6]=r*e+w*f,a[7]=m*e+t*f,a[8]=n*e-h*f,a[9]=p*e-k*f,a[10]=w*e-r*f,a[11]=t*e-m*f,a};p.rotateY=function(a,c,e){var f=Math.sin(e);e=Math.cos(e);var h=c[0],k=c[1],r=c[2],m=c[3],n=c[8],p=c[9],w=c[10],t=c[11];return c!==a&&(a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]),a[0]=h*e-n*f,a[1]=k*e-p*f,a[2]=r*e-w*f,a[3]=m*e-t*f,a[8]=h*f+n*e,a[9]=k*f+p*e,a[10]=r*f+w*e,a[11]=m*f+t*e,a};p.rotateZ=function(a,c,e){var f=Math.sin(e);e=Math.cos(e);var h=
c[0],k=c[1],r=c[2],m=c[3],n=c[4],p=c[5],w=c[6],t=c[7];return c!==a&&(a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]),a[0]=h*e+n*f,a[1]=k*e+p*f,a[2]=r*e+w*f,a[3]=m*e+t*f,a[4]=n*e-h*f,a[5]=p*e-k*f,a[6]=w*e-r*f,a[7]=t*e-m*f,a};p.fromRotationTranslation=function(a,c,e){var f=c[0],h=c[1],k=c[2],r=c[3],m=f+f,n=h+h,p=k+k;c=f*m;var w=f*n,f=f*p,t=h*n,h=h*p,k=k*p,m=r*m,n=r*n,r=r*p;return a[0]=1-(t+k),a[1]=w+r,a[2]=f-n,a[3]=0,a[4]=w-r,a[5]=1-(c+k),a[6]=h+m,a[7]=0,
a[8]=f+n,a[9]=h-m,a[10]=1-(c+t),a[11]=0,a[12]=e[0],a[13]=e[1],a[14]=e[2],a[15]=1,a};p.frustum=function(a,c,e,f,h,k,m){var n=1/(e-c),p=1/(h-f),v=1/(k-m);return a[0]=2*k*n,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*k*p,a[6]=0,a[7]=0,a[8]=(e+c)*n,a[9]=(h+f)*p,a[10]=(m+k)*v,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*(m*k)*v,a[15]=0,a};p.perspective=function(a,c,e,f,h){c=1/Math.tan(c/2);var k=1/(f-h);return a[0]=c/e,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=c,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(h+f)*k,a[11]=-1,a[12]=0,a[13]=0,a[14]=
2*h*f*k,a[15]=0,a};p.ortho=function(a,c,e,f,h,k,m){var n=1/(c-e),p=1/(f-h),v=1/(k-m);return a[0]=-2*n,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*p,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*v,a[11]=0,a[12]=(c+e)*n,a[13]=(h+f)*p,a[14]=(m+k)*v,a[15]=1,a};p.lookAt=function(a,c,f,h){var k,m,n,G,s,v,w,t,F,u,x=c[0],y=c[1];c=c[2];var z=h[0],A=h[1];h=h[2];var B=f[0],C=f[1];f=f[2];return Math.abs(x-B)<e&&Math.abs(y-C)<e&&Math.abs(c-f)<e?p.identity(a):(w=x-B,t=y-C,F=c-f,u=1/Math.sqrt(w*w+t*t+F*F),w*=u,t*=u,F*=u,k=A*F-h*
t,m=h*w-z*F,n=z*t-A*w,u=Math.sqrt(k*k+m*m+n*n),u?(u=1/u,k*=u,m*=u,n*=u):(k=0,m=0,n=0),G=t*n-F*m,s=F*k-w*n,v=w*m-t*k,u=Math.sqrt(G*G+s*s+v*v),u?(u=1/u,G*=u,s*=u,v*=u):(G=0,s=0,v=0),a[0]=k,a[1]=G,a[2]=w,a[3]=0,a[4]=m,a[5]=s,a[6]=t,a[7]=0,a[8]=n,a[9]=v,a[10]=F,a[11]=0,a[12]=-(k*x+m*y+n*c),a[13]=-(G*x+s*y+v*c),a[14]=-(w*x+t*y+F*c),a[15]=1,a)};p.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+
", "+a[13]+", "+a[14]+", "+a[15]+")"};"undefined"!=typeof a&&(a.mat4=p);h={};new Float32Array([0,0,0,1]);h.create=function(){var a=new f(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a};h.clone=m.clone;h.fromValues=m.fromValues;h.copy=m.copy;h.set=m.set;h.identity=function(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a};h.setAxisAngle=function(a,c,e){e*=0.5;var f=Math.sin(e);return a[0]=f*c[0],a[1]=f*c[1],a[2]=f*c[2],a[3]=Math.cos(e),a};h.add=m.add;h.multiply=function(a,c,e){var f=c[0],h=c[1],k=c[2];c=c[3];var m=
e[0],n=e[1],p=e[2];e=e[3];return a[0]=f*e+c*m+h*p-k*n,a[1]=h*e+c*n+k*m-f*p,a[2]=k*e+c*p+f*n-h*m,a[3]=c*e-f*m-h*n-k*p,a};h.mul=h.multiply;h.scale=m.scale;h.rotateX=function(a,c,e){e*=0.5;var f=c[0],h=c[1],k=c[2];c=c[3];var m=Math.sin(e);e=Math.cos(e);return a[0]=f*e+c*m,a[1]=h*e+k*m,a[2]=k*e-h*m,a[3]=c*e-f*m,a};h.rotateY=function(a,c,e){e*=0.5;var f=c[0],h=c[1],k=c[2];c=c[3];var m=Math.sin(e);e=Math.cos(e);return a[0]=f*e-k*m,a[1]=h*e+c*m,a[2]=k*e+f*m,a[3]=c*e-h*m,a};h.rotateZ=function(a,c,e){e*=0.5;
var f=c[0],h=c[1],k=c[2];c=c[3];var m=Math.sin(e);e=Math.cos(e);return a[0]=f*e+h*m,a[1]=h*e-f*m,a[2]=k*e+c*m,a[3]=c*e-k*m,a};h.calculateW=function(a,c){var e=c[0],f=c[1],h=c[2];return a[0]=e,a[1]=f,a[2]=h,a[3]=-Math.sqrt(Math.abs(1-e*e-f*f-h*h)),a};h.dot=m.dot;h.lerp=m.lerp;h.slerp=function(a,c,e,f){var h=c[0],k=c[1],m=c[2],n=c[3],p=e[0],v=e[1];e=e[2];var w=c[3],t=h*p+k*v+m*e+n*w,F,u,x,y;return 1<=Math.abs(t)?(a!==c&&(a[0]=h,a[1]=k,a[2]=m,a[3]=n),a):(F=Math.acos(t),u=Math.sqrt(1-t*t),0.001>Math.abs(u)?
(a[0]=0.5*h+0.5*p,a[1]=0.5*k+0.5*v,a[2]=0.5*m+0.5*e,a[3]=0.5*n+0.5*w,a):(x=Math.sin((1-f)*F)/u,y=Math.sin(f*F)/u,a[0]=h*x+p*y,a[1]=k*x+v*y,a[2]=m*x+e*y,a[3]=n*x+w*y,a))};h.invert=function(a,c){var e=c[0],f=c[1],h=c[2],k=c[3],m=e*e+f*f+h*h+k*k,m=m?1/m:0;return a[0]=-e*m,a[1]=-f*m,a[2]=-h*m,a[3]=k*m,a};h.conjugate=function(a,c){return a[0]=-c[0],a[1]=-c[1],a[2]=-c[2],a[3]=c[3],a};h.length=m.length;h.len=h.length;h.squaredLength=m.squaredLength;h.sqrLen=h.squaredLength;h.normalize=m.normalize;h.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!=typeof a&&(a.quat=h)})(a)})();Pixel.BROWSER_TYPE_CHROME="chrome";Pixel.BROWSER_TYPE_SAFARI="safari";Pixel.BROWSER_TYPE_FIREFOX="firefox";Pixel.BROWSER_TYPE_IPHONE="iphone";Pixel.RENDERER_2D=0;Pixel.RENDERER_WEBGL=1;Pixel.LINE_CAP_NORMAL=0;Pixel.LINE_CAP_ROUND=1;Pixel.LINE_CAP_SQUARE=2;Pixel.TEXT_ALIGN_LEFT=0;Pixel.TEXT_ALIGN_CENTER=1;Pixel.TEXT_ALIGN_RIGHT=2;Pixel.TEXT_BASELINE_TOP=0;Pixel.TEXT_BASELINE_HANGING=1;
Pixel.TEXT_BASELINE_MIDDLE=2;Pixel.TEXT_BASELINE_BOTTOM=3;Pixel.OBJECT_SHAPE_RECT=0;Pixel.OBJECT_SHAPE_CIRCLE=1;Pixel.ALIGNMENT_LEFT_TOP=0;Pixel.ALIGNMENT_LEFT_CENTER=1;Pixel.ALIGNMENT_LEFT_BOTTOM=2;Pixel.ALIGNMENT_RIGHT_TOP=3;Pixel.ALIGNMENT_RIGHT_CENTER=4;Pixel.ALIGNMENT_RIGHT_BOTTOM=5;Pixel.ALIGNMENT_CENTER_TOP=6;Pixel.ALIGNMENT_CENTER_BOTTOM=7;Pixel.ALIGNMENT_CENTER_CENTER=8;Pixel.MOUSE_DOWN_EVENT="PIXEL_MOUSE_DOWN_EVENT";Pixel.MOUSE_DOWN_INSIDE_EVENT="PIXEL_MOUSE_DOWN_INSIDE_EVENT";
Pixel.MOUSE_MOVE_EVENT="PIXEL_MOUSE_MOVE_EVENT";Pixel.MOUSE_UP_EVENT="PIXEL_MOUSE_UP_EVENT";Pixel.MOUSE_UP_INSIDE_EVENT="PIXEL_MOUSE_UP_INSIDE_EVENT";Pixel.KEY_DOWN_EVENT="PIXEL_KEY_DOWN_EVENT";Pixel.KEY_PRESS_EVENT="PIXEL_KEY_PRESS_EVENT";Pixel.KEY_UP_EVENT="PIXEL_KEY_UP_EVENT";Pixel.log=function(a){console.log("PixelJS: "+a)};Pixel.isTouchDevice=function(){return"ontouchstart"in window};Pixel.getDeviceScale=function(){return window.devicePixelRatio};
Pixel.hideAddressBar=function(){window.scrollTo(0,1)};window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,c){window.setTimeout(a,1E3/60)}}();Pixel.getRelativeMouseCoords=function(a,c){var e=0,f=0,h=0,k=0,h=c;do e+=h.offsetLeft,f+=h.offsetTop;while(h=h.offsetParent);h=a.pageX-e;k=a.pageY-f;return new Pixel.Point(h,k)};Pixel.Math={};
Pixel.Math.radiansToDegrees=function(a){return a*(180/Math.PI)};Pixel.Math.degreesToRadians=function(a){return a*(Math.PI/180)};Pixel.Math.map=function(a,c,e,f,h,k){e=f+(h-f)*((e-a)/(c-a));return k?Pixel.clamp(e):e};Pixel.Math.clamp=function(a,c,e){a=Math.max(a,c);return a=Math.min(a,e)};Pixel.Math.dist=function(a,c,e,f,h){a=Math.sqrt(Math.pow(e-a,2)+Math.pow(f-c,2));return h?a:Math.abs(a)};Pixel.Math.getAngle=function(a,c,e,f){return Math.atan2(f-c,e-a)};
Pixel.Math.isPowerOfTwo=function(a){return 0==(a&a-1)};Pixel.Point=function(a,c,e){this.x=a||0;this.y=c||0;this.z=e||0};Pixel.Point.prototype.set=function(a,c,e){this.x=a||0;this.y=c||0;this.z=e||0};Pixel.Rect=function(a,c,e,f){this.height=this.width=this.y=this.x=0;this.set(a,c,e,f)};Pixel.Rect.prototype.top=function(){return this.y};Pixel.Rect.prototype.right=function(){return this.x+this.width};Pixel.Rect.prototype.bottom=function(){return this.y+this.height};Pixel.Rect.prototype.left=function(){return this.x};
Pixel.Rect.prototype.set=function(a,c,e,f){this.setPos(a,c);this.setSize(e,f)};Pixel.Rect.prototype.setPos=function(a,c){this.x=a;this.y=c};Pixel.Rect.prototype.setSize=function(a,c){this.width=a;this.height=c};Pixel.Rect.prototype.getPos=function(){return{x:this.x,y:this.y}};Pixel.Rect.prototype.getSize=function(){return{width:this.width,height:this.height}};
Pixel.Rect.prototype.pointInside=function(a,c){return void 0!=c?a>this.x&&a<this.x+this.width&&c>this.y&&c<this.y+this.height:a.x>this.x&&a.x<this.x+this.width&&a.y>this.y&&a.y<this.y+this.height};Pixel.Rect.prototype.include=function(a){a.x<this.x&&(this.width+=this.x-a.x,this.x=a.x);a.y<this.y&&(this.height+=this.y-a.y,this.y=a.y);a.right()>this.right()&&(this.width+=a.right()-this.right());a.bottom()>this.bottom()&&(this.height+=a.bottom()-this.bottom())};Pixel.FontSizeCvs=null;
Pixel.Font=function(a){this.fontFamily=a||"Arial";this.alignment=Pixel.TEXT_ALIGN_LEFT;this.baseline=Pixel.TEXT_BASELINE_TOP;null==Pixel.FontSizeCvs&&(Pixel.FontSizeCvs=new Pixel.Canvas(Pixel.RENDER_MODE_2D))};Pixel.Font.prototype.setFamily=function(a){this.fontFamily=fontName;return this};Pixel.Font.prototype.getFamily=function(a){return this.fontFamily};Pixel.Font.prototype.setBaseline=function(a){this.baseline=a;return this};
Pixel.Font.prototype.getTextWidth=function(a,c){Pixel.FontSizeCvs.setFont(this.fontFamily,c);return Pixel.FontSizeCvs.getTextWidth(a)};
Pixel.Font.prototype.getTextHeight=function(a,c){a=document.createElement("span");a.style.font=c+"px "+this.fontFamily;a.innerHTML=a;var e=document.createElement("div");e.style.display="inline-block";e.style.width="1px";e.style.height="0px";var f=document.createElement("div");f.appendChild(a);f.appendChild(e);document.body.appendChild(f);try{var h={};e.style.verticalAlign="baseline";h.ascent=e.offsetTop-a.offsetTop;e.style.verticalAlign="bottom";h.height=e.offsetTop-a.offsetTop;h.descent=h.height-
h.ascent}finally{document.body.removeChild(f)}return h};Pixel.Font.prototype.getTextMetrics=function(a,c){var e=this.getTextWidth(a,c),f=this.getTextHeight(a,c);return{width:e,height:f.height,ascent:f.ascent,descent:f.descent}};Pixel.Color=function(a,c,e,f){this.r=a||0;this.g=c||0;this.b=e||0;this.a=f||1;this.v=this.l=this.s=this.h=0};Pixel.Color.prototype.init=function(a,c,e,f){this.r=a||0;this.g=c||0;this.b=e||0;this.a=f||1};
Pixel.Color.prototype.set=function(a,c,e,f){a instanceof Pixel.Color?(this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a):(void 0!=a&&(this.r=a),void 0!=c&&(this.g=c),void 0!=e&&(this.b=e),this.a=void 0!=f?f:1)};Pixel.Color.prototype.normalizeRGB=function(){this.r=Pixel.Math.map(0,255,this.r,0,1);this.g=Pixel.Math.map(0,255,this.g,0,1);this.b=Pixel.Math.map(0,255,this.b,0,1)};
Pixel.Color.prototype.setHSL=function(a,c,e,f){void 0!=a&&(this.h=a);void 0!=c&&(this.s=g);void 0!=e&&(this.l=b);this.a=void 0!=f?f:1};Pixel.Color.prototype.setHSV=function(a,c,e,f){void 0!=a&&(this.h=a);void 0!=c&&(this.s=g);void 0!=e&&(this.l=b);void 0!=f&&(this.a=f)};Pixel.Color.prototype.toHSL=function(){var a=Pixel.rgbToHSL(this.r,this.g,this.b);this.setHSL(a.h,a.s,a.l);return a};Pixel.Color.prototype.toHSV=function(){var a=Pixel.rgbToHSV(this.r,this.g,this.b);this.setHSV(a.h,a.s,a.v);return a};
Pixel.Color.prototype.toRGBAString=function(){return Pixel.getColorAsRGBAString(this.r,this.g,this.b,this.a)};Pixel.getColorAsRGBAString=function(a,c,e,f){a=Math.round(a);c=Math.round(c);e=Math.round(e);return void 0==c?"rgba("+a+","+c+","+e+","+f+")":void 0==f?"rgba("+a+","+c+","+e+",255)":"rgba("+a+","+c+","+e+","+f+")"};
Pixel.rgbToHsl=function(a,c,e){a/=255;c/=255;e/=255;var f=Math.max(a,c,e),h=Math.min(a,c,e),k,n=(f+h)/2;if(f==h)k=h=0;else{var m=f-h,h=0.5<n?m/(2-f-h):m/(f+h);switch(f){case a:k=(c-e)/m+(c<e?6:0);break;case c:k=(e-a)/m+2;break;case e:k=(a-c)/m+4}k/=6}return{h:k,s:h,l:n}};
Pixel.hslToRgb=function(a,c,e){a=Pixel.map(a,0,360,0,1);c=Pixel.map(c,0,255,0,1);e=Pixel.map(e,0,255,0,1);if(0==c)e=c=a=e;else{var f=function(a,c,e){0>e&&(e+=1);1<e&&(e-=1);return e<1/6?a+6*(c-a)*e:0.5>e?c:e<2/3?a+6*(c-a)*(2/3-e):a},h=0.5>e?e*(1+c):e+c-e*c,k=2*e-h;e=f(k,h,a+1/3);c=f(k,h,a);a=f(k,h,a-1/3)}return{r:255*e,g:255*c,b:255*a}};
Pixel.rgbToHsv=function(a,c,e){a/=255;c/=255;e/=255;var f=Math.max(a,c,e),h=Math.min(a,c,e),k,n=f-h;if(f==h)k=0;else{switch(f){case a:k=(c-e)/n+(c<e?6:0);break;case c:k=(e-a)/n+2;break;case e:k=(a-c)/n+4}k/=6}return{h:k,s:0==f?0:n/f,v:f}};
Pixel.hsvToRgb=function(a,c,e){a=Pixel.map(a,0,360,0,1);c=Pixel.map(c,0,255,0,1);e=Pixel.map(e,0,255,0,1);var f,h,k,n=Math.floor(6*a),m=6*a-n;a=e*(1-c);var p=e*(1-m*c);c=e*(1-(1-m)*c);switch(n%6){case 0:f=e;h=c;k=a;break;case 1:f=p;h=e;k=a;break;case 2:f=a;h=e;k=c;break;case 3:f=a;h=p;k=e;break;case 4:f=c;h=a;k=e;break;case 5:f=e,h=a,k=p}return{r:255*f,g:255*h,b:255*k}};
Pixel.normalizeRGB=function(a){var c=Pixel.Math.map(0,255,a.r,0,1),e=Pixel.Math.map(0,255,a.g,0,1),f=Pixel.Math.map(0,255,a.b,0,1);return new Pixel.Color(c,e,f,a.a)};
Pixel.Object=function(){this.canvas=null;this.name="";this.position=new Pixel.Point(0,0,0);this.offset=new Pixel.Point(0,0,0);this.matrix=mat4.create();this.height=this.width=0;this.bounds=new Pixel.Rect(0,0,0,0);this.shouldDrawBounds=!1;this.rotation=0;this.alignment=Pixel.ALIGNMENT_TOP_LEFT;this.scaleAmount=new Pixel.Point(1,1,0);this.rotation=0;this.alpha=1;this.cache=null;this.isCaching=!1;this.visible=!0;this.parent=null;this.children=[];this.drawOrder=-1;this.events=[]};
Pixel.Object.prototype.update=function(){for(var a=0;a<this.children.length;a++)this.children[a].update()};
Pixel.Object.prototype.drawTree=function(){if(this.canvas&&this.visible&&0<this.alpha){this.calculateOffset();this.setTransformation();this.pushAlpha();this.drawOrder=this.canvas.getNextDrawOrder();if(!1==this.isCaching){this.draw();!1!=this.shouldDrawBounds&&this.drawBounds();for(var a=0;a<this.children.length;a++)this.children[a].drawTree()}else this.canvas.drawImage(this.cache.element,0,0,this.cache.getWidth(),this.cache.getHeight());this.unsetTransformation();this.popAlpha()}};
Pixel.Object.prototype.draw=function(){};Pixel.Object.prototype.setCanvas=function(a){this.canvas=a;for(var c=this.children.length;c--;)this.children[c].setCanvas(a)};Pixel.Object.prototype.getCanvas=function(){return this.canvas};Pixel.Object.prototype.addChild=function(a){null!=a.parent&&a.parent.removeChild(a);a.parent=this;this.children.push(a);!1==this.isCaching?a.setCanvas(this.canvas):(a.setCanvas(this.cache),this.doCaching());return this};
Pixel.Object.prototype.removeChild=function(a){var c=this.getChildPosition(a);return-1!=c?(a.parent=null,a.canvas=null,this.children.splice(c,1),!0):!1};Pixel.Object.prototype.moveChildForward=function(a){if(a==this.children[this.children.length-1])return!0;var c=this.getChildPosition(a);return-1!=c?(this.children.splice(c,1),c<this.children.length?this.children.splice(c+1,0,a):this.children.push(a),!0):!1};
Pixel.Object.prototype.moveChildToFront=function(a){var c=this.getChildPosition(a);return-1!=c?(this.children.splice(c,1),this.children.push(a),!0):!1};Pixel.Object.prototype.moveChildBackward=function(a){if(a==this.children[0])return!0;var c=this.getChildPosition(a);return-1!=c?(this.children.splice(c,1),0<c-1?this.children.splice(c-1,0,a):this.children.unshift(a),!0):!1};
Pixel.Object.prototype.moveChildToBack=function(a){var c=this.getChildPosition(a);return-1!=c?(this.children.splice(c,1),this.children.unshift(a),!0):!1};Pixel.Object.prototype.getChildPosition=function(a){for(var c=0;c<this.children.length;c++)if(this.children[c]==a)return c;return-1};Pixel.Object.prototype.getParent=function(){return this.parent};Pixel.Object.prototype.setVisible=function(a){this.visible=a};Pixel.Object.prototype.isVisible=function(){return this.visible};
Pixel.Object.prototype.setAlpha=function(a){this.alpha=a};Pixel.Object.prototype.pushAlpha=function(){this.getCanvas().setAlpha(this.getCanvas().getAlpha()*this.alpha)};Pixel.Object.prototype.popAlpha=function(){this.getCanvas().setAlpha(this.getCanvas().getAlpha()/this.alpha)};
Pixel.Object.prototype.setTransformation=function(){this.canvas.pushMatrix();this.canvas.translate(this.position.x,this.position.y,0);this.canvas.rotate(this.rotation);this.canvas.scale(this.scaleAmount.x,this.scaleAmount.y);this.canvas.translate(this.offset.x,this.offset.y,0);mat4.copy(this.matrix,this.canvas.getTransformation())};Pixel.Object.prototype.unsetTransformation=function(){this.canvas.popMatrix()};Pixel.Object.prototype.setRotation=function(a){this.rotation=a;return this};
Pixel.Object.prototype.getRotation=function(){return this.rotation};Pixel.Object.prototype.getWidth=function(){return this.bounds.width};Pixel.Object.prototype.getScaledWidth=function(){return this.bounds.width*this.scaleAmount.x};Pixel.Object.prototype.getHeight=function(){return this.bounds.height};Pixel.Object.prototype.getScaledHeight=function(){return this.bounds.height*this.scaleAmount.y};Pixel.Object.prototype.getSize=function(){return{width:this.getWidth(),height:this.getHeight()}};
Pixel.Object.prototype.setPosition=function(a,c,e){this.position.set(a,c,e);return this};Pixel.Object.prototype.getPosition=function(){return this.position};Pixel.Object.prototype.getBounds=function(){this.calculateBounds();return this.bounds};
Pixel.Object.prototype.calculateBounds=function(){this.bounds.set(0,0,0,0);for(var a=new Pixel.Rect(0,0,0,0),c=0;c<this.children.length;c++){var e=this.children[c].getBounds();a.set(e.x,e.y,e.width,e.height);a.x+=this.children[c].position.x;a.y+=this.children[c].position.y;this.bounds.include(a)}};Pixel.Object.prototype.setDrawBounds=function(a){this.shouldDrawBounds=a;return this};Pixel.Object.prototype.getDrawBounds=function(){return this.shouldDrawBounds};
Pixel.Object.prototype.drawBounds=function(){this.canvas.setStrokeSize(1);this.canvas.setStrokeColor(255,0,0);this.canvas.noFill();this.canvas.drawRect(this.bounds.x,this.bounds.y,this.getWidth(),this.getHeight());this.canvas.setFillColor(255,0,0);this.canvas.noStroke();this.canvas.drawRect(-2,-2,4,4)};Pixel.Object.prototype.pointInside=function(a){return a.x>=this.getBounds().x&&a.x<this.getBounds().x+this.getWidth()&&a.y>this.getBounds().y&&a.y<this.getBounds().y+this.getHeight()?!0:!1};
Pixel.Object.prototype.setAlignment=function(a){this.alignment=a;return this};
Pixel.Object.prototype.calculateOffset=function(){switch(this.alignment){case Pixel.ALIGNMENT_LEFT_TOP:this.offset.set(0,0);break;case Pixel.ALIGNMENT_LEFT_CENTER:this.offset.set(0,-this.getHeight()/2);break;case Pixel.ALIGNMENT_LEFT_BOTTOM:this.offset.set(0,-this.getHeight());break;case Pixel.ALIGNMENT_RIGHT_TOP:this.offset.set(-this.getWidth(),0);break;case Pixel.ALIGNMENT_RIGHT_CENTER:this.offset.set(-this.getWidth(),-this.getHeight()/2);break;case Pixel.ALIGNMENT_RIGHT_BOTTOM:this.offset.set(-this.getWidth(),
-this.getHeight());break;case Pixel.ALIGNMENT_CENTER_TOP:this.offset.set(-this.getWidth()/2,0);break;case Pixel.ALIGNMENT_CENTER_BOTTOM:this.offset.set(-this.getWidth()/2,-this.getHeight());break;case Pixel.ALIGNMENT_CENTER_CENTER:this.offset.set(-this.getWidth()/2,-this.getHeight()/2)}};
Pixel.Object.prototype.setCaching=function(a){if(this.isCaching=a){if(null==this.cache)for(this.createCache(),a=this.children.length;a--;)this.children[a].setCanvas(this.cache);this.doCaching()}else{for(a=this.children.length;a--;)this.children[a].setCanvas(this.canvas);delete this.cache}return this};Pixel.Object.prototype.createCache=function(){this.cache=new Pixel.Canvas;this.calculateBounds();this.cache.setSize(this.getWidth()*window.devicePixelRatio,this.getHeight()*window.devicePixelRatio)};
Pixel.Object.prototype.updateCache=function(){this.isCaching||this.setCaching(!0);this.doCaching();return this};
Pixel.Object.prototype.doCaching=function(){this.calculateBounds();this.cache.setSize(this.getWidth()*window.devicePixelRatio,this.getHeight()*window.devicePixelRatio);this.cache.pushMatrix();this.cache.scale(window.devicePixelRatio,window.devicePixelRatio,1);for(var a=0;a<this.children.length;a++)this.children[a].setCanvas(this.cache),this.children[a].drawTree(),this.children[a].setCanvas(this.canvas);this.cache.popMatrix()};
Pixel.Object.prototype.getLocalPosition=function(a){a=vec3.fromValues(a.x,a.y,a.z);var c=vec3.create(),e=mat4.clone(this.matrix);mat4.invert(e,e);vec3.transformMat4(c,a,e);return new Pixel.Point(c[0],c[1],0)};Pixel.Object.prototype.addEvent=function(a,c,e){Pixel.EventCenter.addListener(a,this,c,e);return this};Pixel.Object.prototype.removeEvents=function(a){Pixel.EventCenter.removeListener(this,a);return this};
Pixel.Object.prototype.removeAllEvents=function(){Pixel.EventCenter.removeAllListeners(this);return this};Pixel.Object.prototype.eventHandler=function(a){console.log(a.localPosition);console.log(a.data)};Pixel.Object.prototype.messageHandler=function(a){};Pixel.Shape2D=function(){Pixel.Object.call(this);this.fillColor=new Pixel.Color(255,255,255);this.fillEnabled=!0;this.strokeColor=new Pixel.Color;this.strokeSize=1;this.strokeEnabled=!1;this.path=null};Pixel.Shape2D.prototype=Object.create(Pixel.Object.prototype);
Pixel.Shape2D.prototype.addChild=function(a){Pixel.log("Error: Children cannot be added to a shape object")};Pixel.Shape2D.prototype.enableFill=function(){this.fillEnabled=!0;return this};Pixel.Shape2D.prototype.disableFill=function(){this.fillEnabled=!1;return this};Pixel.Shape2D.prototype.setFillColor=function(a,c,e,f){this.fillColor.set(a,c,e,f);return this};Pixel.Shape2D.prototype.enableStroke=function(){this.strokeEnabled=!0;return this};
Pixel.Shape2D.prototype.disableStroke=function(){this.strokeEnabled=!1;return this};Pixel.Shape2D.prototype.setStrokeSize=function(a){this.strokeSize=a;this.strokeEnabled=!0;return this};Pixel.Shape2D.prototype.setStrokeColor=function(a,c,e,f){this.strokeColor.set(a,c,e,f);return this};Pixel.Shape2D.prototype.getWidth=function(){return this.width};Pixel.Shape2D.prototype.setWidth=function(a){this.width=a;return this};Pixel.Shape2D.prototype.getHeight=function(){return this.height};
Pixel.Shape2D.prototype.setHeight=function(a){this.height=a;return this};Pixel.Shape2D.prototype.getSize=function(){return{width:this.getWidth(),height:this.getHeight()}};Pixel.Shape2D.prototype.setSize=function(a,c){this.setWidth(a);this.setHeight(c);return this};Pixel.Shape2D.prototype.getBounds=function(){this.calculateOffset();return new Pixel.Rect(this.offset.x,this.offset.y,this.getWidth(),this.getHeight())};Pixel.RectShape=function(){Pixel.Shape2D.call(this)};Pixel.RectShape.prototype=Object.create(Pixel.Shape2D.prototype);
Pixel.RectShape.prototype.draw=function(){this.fillEnabled?this.canvas.setFillColor(this.fillColor):this.canvas.noFill();this.strokeEnabled?(this.canvas.setStrokeSize(this.strokeSize),this.canvas.setStrokeColor(this.strokeColor)):this.canvas.noStroke();this.canvas.drawRect(0,0,this.width,this.height)};Pixel.EllipseShape=function(){Pixel.Shape2D.call(this)};Pixel.EllipseShape.prototype=Object.create(Pixel.Shape2D.prototype);
Pixel.EllipseShape.prototype.draw=function(){this.fillEnabled&&this.canvas.setFillColor(this.fillColor);this.strokeEnabled&&(this.canvas.setStrokeSize(this.strokeSize),this.canvas.setStrokeColor(this.strokeColor));this.width==this.height?this.canvas.drawCircle(0,0,this.width):this.canvas.drawEllipse(0,0,this.width,this.height);this.shouldDrawBounds&&this.drawBounds()};Pixel.ImageShape=function(a){Pixel.Shape2D.call(this);this.pixels=this.imageData=this.image=null;this.load(a)};
Pixel.ImageShape.prototype=Object.create(Pixel.Shape2D.prototype);
Pixel.ImageShape.prototype.load=function(a){if(void 0!=a)if(a instanceof Pixel.Canvas)this.image=a.element,this.width=a.width,this.height=a.height;else if("CANVAS"==a.tagName||a instanceof Image)this.image=a,this.width=this.image.width,this.height=this.image.height;else if("string"==typeof a){this.image=new Image;var c=this;this.image.onload=function(){if(0==c.width||0==this.height)c.width=this.width,c.height=this.height};this.image.src=a}};
Pixel.ImageShape.prototype.draw=function(){this.canvas&&this.visible&&null!=this.image&&("image"!=typeof this.image||!1!=this.image.complete)&&(this.canvas.pushMatrix(),this.canvas.translate(this.position.x,this.position.y,this.position.z),this.canvas.rotate(this.rotation),this.calculateOffset(),this.canvas.drawImage(this.image,this.offset.x,this.offset.y,this.width,this.height),0<this.strokeWidth&&(this.canvas.setStrokeSize(this.strokeWidth),this.canvas.setStrokeColor(this.strokeColor),this.canvas.noFill(),
this.canvas.drawRect(this.offset.x,this.offset.y,this.width,this.height)),this.canvas.popMatrix())};Pixel.ImageShape.prototype.convertImageToCanvas=function(){var a=document.createElement("canvas");a.width=this.image.width;a.height=this.image.height;a.getContext("2d").drawImage(this.image,0,0,this.image.width,this.image.height);this.image=a};
Pixel.ImageShape.prototype.getPixels=function(){if(this.image)return"CANVAS"==this.image.tagName&&this.pixels||this.convertImageToCanvas(),this.imageData=this.image.getContext("2d").getImageData(0,0,this.image.width,this.image.height),this.pixels=this.imageData.data;Pixel.log("Get Pixels: Image not loaded")};
Pixel.ImageShape.prototype.setPixels=function(a){"CANVAS"==this.image.tagName&&this.pixels||this.convertImageToCanvas();this.imageData.data=a;this.image.getContext("2d").putImageData(this.imageData,0,0)};
Pixel.TextField=function(a){Pixel.Shape2D.call(this);this.width=100;this.height=50;this.textHeight=this.textWidth=0;this.useTextBounds=!1;this.font=a||new Pixel.Font("Arial",14);this.leading=null;this.textAlignment=Pixel.TEXT_ALIGN_LEFT;this.textColor=new Pixel.Color(255,255,255,1);this.textSize=10;this.text="";this.hideOverflow=!1;this.lines=[];this.fillEnabled=!1};Pixel.TextField.prototype=Object.create(Pixel.Shape2D.prototype);
Pixel.TextField.prototype.setUseTextBounds=function(a){this.useTextBounds=a;return this};Pixel.TextField.prototype.getUseTextBounds=function(a){return this.useTextBounds};Pixel.TextField.prototype.getWidth=function(){return this.useTextBounds?this.textWidth:this.width};Pixel.TextField.prototype.getHeight=function(){return this.useTextBounds?this.textHeight:this.height};
Pixel.TextField.prototype.getBounds=function(){this.calculateOffset();this.bounds.set(this.offset.x,this.offset.y,this.getWidth(),this.getHeight());return this.bounds};Pixel.TextField.prototype.setFont=function(a){a instanceof Pixel.Font?this.font=a:Pixel.log("Not a valid Pixel font object.");return this};Pixel.TextField.prototype.setTextColor=function(a,c,e,f){this.textColor.set(a,c,e,f);return this};Pixel.TextField.prototype.setTextSize=function(a){this.textSize=a;return this};
Pixel.TextField.prototype.setTextAlignment=function(a){this.textAlignment=a;return this};Pixel.TextField.prototype.getTextAlignment=function(){return this.textAlignment};Pixel.TextField.prototype.setLeading=function(a){this.leading=a;return this};Pixel.TextField.prototype.getLeading=function(){return this.leading};Pixel.TextField.prototype.setHideOverflow=function(a){this.hideOverflow=a;return this};Pixel.TextField.prototype.getText=function(a){return this.hideOverflow};
Pixel.TextField.prototype.setText=function(a){this.text=a.toString();return this};Pixel.TextField.prototype.getText=function(a){return this.text};
Pixel.TextField.prototype.doLayout=function(){this.lines=[];for(var a=this.textHeight=this.textWidth=0,c=this.text.split(" "),e=this.newLine(),f=c.length,h=0;h<f;h++){e.width=this.font.getTextWidth(e.text,this.textSize);var k=this.font.getTextWidth(c[h],this.textSize);if(e.width+k<this.width)e.text+=c[h],h!=f-1&&(e.text+=" ");else{e.metrics=this.font.getTextMetrics(e.text,this.textSize);e.position.x=this.getLineXPos(e.metrics.width);e.position.y=a;this.lines.push(e);null==this.leading&&(this.leading=
1.2*e.metrics.height);a+=e.metrics.descent+this.leading;e=a+e.metrics.descent+this.leading;if(this.hideOverflow&&e>this.height){this.calculateTextBounds();return}e=this.newLine();e.text=c[h]}}e.metrics=this.font.getTextMetrics(e.text,this.textSize);e.position.x=this.getLineXPos(e.metrics.width);e.position.y=a;this.lines.push(e);this.calculateTextBounds();return this};
Pixel.TextField.prototype.getLineXPos=function(a){var c=0;switch(this.textAlignment){case Pixel.TEXT_ALIGN_CENTER:c=this.width/2-a/2;break;case Pixel.TEXT_ALIGN_RIGHT:c=this.width-a}return c};Pixel.TextField.prototype.getLines=function(){return this.lines};Pixel.TextField.prototype.newLine=function(){return{text:"",position:new Pixel.Point,metrics:null}};
Pixel.TextField.prototype.calculateTextBounds=function(){for(var a=0;a<this.lines.length;a++)this.textWidth=this.lines[a].metrics.width>this.textWidth?this.lines[a].metrics.width:this.textWidth;a=this.lines[this.lines.length-1];this.textHeight=a.position.y+a.metrics.height};
Pixel.TextField.prototype.draw=function(){this.fillEnabled?this.canvas.setFillColor(this.fillColor):this.canvas.noFill();this.strokeEnabled?(this.canvas.setStrokeSize(this.strokeSize),this.canvas.setStrokeColor(this.strokeColor)):this.canvas.noStroke();this.calculateOffset();var a=this.getBounds();this.canvas.drawRect(this.offset.x,this.offset.y,a.width,a.height);this.canvas.setFillColor(this.textColor);this.canvas.setFont(this.font.fontFamily,this.textSize);this.canvas.setTextBaseline(this.font.baseline);
for(var a=this.lines.length,c=0;c<a;c++){var e=this.lines[c];this.canvas.drawText(e.text,e.position.x,e.position.y)}};Pixel.Event=function(){this.data=this.type=null;this.propogate=!0};Pixel.Event.prototype.stopPropogation=function(){this.propogate=!1};Pixel.MouseEvent=function(a,c){Pixel.Event.call(this);this.type=a;this.position=c;this.localPosition=null};Pixel.MouseEvent.prototype=Object.create(Pixel.Event.prototype);
Pixel.isMouseEvent=function(a){return a==Pixel.MOUSE_DOWN_EVENT||a==Pixel.MOUSE_DOWN_INSIDE_EVENT||a==Pixel.MOUSE_MOVE_EVENT||a==Pixel.MOUSE_UP_EVENT||a==Pixel.MOUSE_UP_INSIDE_EVENT?!0:!1};Pixel.KeyEvent=function(a,c,e){Pixel.Event.call(this);this.type=a;this.keyCode=e;this.charCode=c};Pixel.isKeyEvent=function(a){return a==Pixel.KEY_DOWN_EVENT||a==Pixel.KEY_PRESS_EVENT||a==Pixel.KEY_UP_EVENT?!0:!1};Pixel.EventCenter={};Pixel.EventCenter.queue={};Pixel.EventCenter.listeners={};
Pixel.EventCenter.Listener=function(){this.responder=this.object=null;this.data={}};Pixel.EventCenter.addListener=function(a,c,e,f){var h=Pixel.EventCenter.listeners;a in h||(h[a]=[]);var k=new Pixel.EventCenter.Listener;k.object=c;k.responder=e;void 0!=f&&(k.data=f);h[a].push(k)};Pixel.EventCenter.removeListener=function(a,c){var e=Pixel.EventCenter.listeners;if(c in e)for(var f=0;f<e[c].length;f++)if(e[c][f].object==a){e[c].splice(f,1);break}};
Pixel.EventCenter.removeAllListeners=function(a){var c=Pixel.EventCenter.listeners,e;for(e in c)removeListener(e,a)};Pixel.EventCenter.sortListenersByDrawOrder=function(a){a.sort(function(a,e){return a.object.drawOrder<e.object.drawOrder})};Pixel.EventCenter.queueEvent=function(a,c){c in Pixel.EventCenter.queue||(Pixel.EventCenter.queue[c]=[]);Pixel.EventCenter.queue[c].push(a)};
Pixel.EventCenter.dispatchEvents=function(a){if(a in Pixel.EventCenter.queue){for(var c=Pixel.EventCenter.queue[a],e=Pixel.EventCenter.listeners,f=0;f<c.length;f++){var h=c[f];if(c[f].type in e){Pixel.EventCenter.sortListenersByDrawOrder(e[h.type]);for(var k=0;k<e[c[f].type].length;k++)if(h.propogate){var n=e[h.type][k].object,m=e[h.type][k].responder;n.getCanvas()==a&&(h.data=e[h.type][k].data,Pixel.isMouseEvent(h.type)?this.handleMouseEvent(h,n,m):Pixel.isKeyEvent(h.type)&&m.eventHandler(h))}else break}}Pixel.EventCenter.queue[a]=
[]}};Pixel.EventCenter.handleMouseEvent=function(a,c,e){a.localPosition=c.getLocalPosition(a.position);a.source=c;switch(a.type){case Pixel.MOUSE_DOWN_INSIDE_EVENT:case Pixel.MOUSE_UP_INSIDE_EVENT:if(!c.pointInside(a.localPosition))return}e.eventHandler(a)};
Pixel.Canvas=function(a){Pixel.Object.call(this);this.element=document.createElement("canvas");this.element.innerHTML="Your browser does not support HTML5 Canvas.";this.pos={x:0,y:0};this.canvas=this;this.height=this.width=0;this.backgroundColor=null;cursorY=cursorX=0;this.bPixelDoubling=2<=window.devicePixelRatio;this.setRenderer(this.element,a);this.setSize(400,400);var c=this;this.element.addEventListener("mousedown",function(a){c.mouseDownListener.call(c,a)},!1);this.element.addEventListener("mousemove",
function(a){c.mouseMovedListener.call(c,a)},!1);this.element.addEventListener("mouseup",function(a){c.mouseUpListener.call(c,a)},!1);document.addEventListener("keydown",function(a){c.keyDownListener.call(c,a)},!1);document.addEventListener("keypress",function(a){c.keyPressListener.call(c,a)},!1);document.addEventListener("keyup",function(a){c.keyUpListener.call(c,a)},!1);this.drawOrderStack=0};Pixel.Canvas.prototype=Object.create(Pixel.Object.prototype);
Pixel.Canvas.prototype.setSize=function(a,c){this.width=a;this.height=c;this.element.style.width=a;this.element.style.height=c;this.element.setAttribute("width",a*window.devicePixelRatio);this.element.setAttribute("height",c*window.devicePixelRatio);this.renderer.setSize(a,c)};Pixel.Canvas.prototype.getWidth=function(){return this.width};Pixel.Canvas.prototype.getHeight=function(){return this.height};
Pixel.Canvas.prototype.enableNativeResolution=function(){this.renderer.scale(window.devicePixelRatio,window.devicePixelRatio)};Pixel.Canvas.prototype.setCursor=function(a,c){this.cursorX=a;this.cursorY=c};Pixel.Canvas.prototype.setRenderer=function(a,c){if(c==Pixel.RENDERER_WEBGL){this.renderer=new Pixel.RendererWebGL(a);if(this.renderer.gl){Pixel.log("WebGL renderer initialized");return}delete this.renderer;Pixel.log("Failed to create WebGL Renderer")}this.renderer=new Pixel.Renderer2D(a)};
Pixel.Canvas.prototype.getRenderer=function(){return this.renderer.type};Pixel.Canvas.prototype.setBackgroundColor=function(a,c,e,f){this.renderer.setBackgroundColor(a,c,e,f)};Pixel.Canvas.prototype.setAlpha=function(a){this.renderer.setAlpha(a)};Pixel.Canvas.prototype.getAlpha=function(a){return this.renderer.getAlpha()};Pixel.Canvas.prototype.clear=function(a,c,e,f){this.renderer.clear(a,c,e,f)};
Pixel.Canvas.prototype.setFillColor=function(a,c,e,f){void 0!=c?this.renderer.setFillColor(a,c,e,f):this.renderer.setFillColor(a.r,a.g,a.b,a.a)};Pixel.Canvas.prototype.noFill=function(){this.renderer.noFill()};Pixel.Canvas.prototype.setStrokeColor=function(a,c,e,f){void 0!=c?this.renderer.setStrokeColor(a,c,e,f):this.renderer.setStrokeColor(a.r,a.g,a.b,a.a)};Pixel.Canvas.prototype.noStroke=function(){this.renderer.noStroke()};
Pixel.Canvas.prototype.setStrokeSize=function(a){a?this.renderer.setStrokeSize(a):this.renderer.noStroke()};Pixel.Canvas.prototype.setLineCap=function(a){this.renderer.setLineCap(a)};Pixel.Canvas.prototype.drawImage=function(a,c,e,f,h){this.renderer.drawImage(a,c,e,f,h)};Pixel.Canvas.prototype.beginShape=function(a,c){this.renderer.beginShape(a,c)};Pixel.Canvas.prototype.addVertex=function(a,c,e){this.renderer.addVertex(a,c,e)};
Pixel.Canvas.prototype.endShape=function(a,c){this.renderer.endShape(a,c)};Pixel.Canvas.prototype.drawLine=function(a,c,e,f){this.renderer.drawLine(a,c,e,f)};Pixel.Canvas.prototype.dashedLine=function(a,c,e,f,h){this.renderer.dashedLine(a,c,e,f,h)};Pixel.Canvas.prototype.drawRect=function(a,c,e,f){this.renderer.drawRect(a,c,e,f)};Pixel.Canvas.prototype.drawRoundedRect=function(a,c,e,f,h){this.renderer.drawRoundedRect(a,c,e,f,h)};
Pixel.Canvas.prototype.drawSquare=function(a,c,e){this.renderer.drawSquare(a,c,e)};Pixel.Canvas.prototype.drawEllipse=function(a,c,e,f){this.renderer.drawEllipse(a,c,e,f)};Pixel.Canvas.prototype.drawCircle=function(a,c,e){this.renderer.drawCircle(a,c,e)};Pixel.Canvas.prototype.pushMatrix=function(){this.renderer.pushMatrix()};Pixel.Canvas.prototype.popMatrix=function(){this.renderer.popMatrix()};Pixel.Canvas.prototype.translate=function(a,c){this.renderer.translate(a,c)};
Pixel.Canvas.prototype.scale=function(a,c){this.renderer.scale(a,c)};Pixel.Canvas.prototype.rotate=function(a){this.renderer.rotate(a)};Pixel.Canvas.prototype.transform=function(a,c,e,f,h,k){this.renderer.transform(a,c,e,f,h,k)};Pixel.Canvas.prototype.setTransform=function(a,c,e,f,h,k){this.renderer.setTransform(a,c,e,f,h,k)};Pixel.Canvas.prototype.getTransformation=function(){return this.renderer.getTransformation()};Pixel.Canvas.prototype.setFont=function(a,c){this.renderer.setFont(a,c)};
Pixel.Canvas.prototype.setTextAlignment=function(a){this.renderer.setTextAlignment(a)};Pixel.Canvas.prototype.setTextBaseline=function(a){this.renderer.setTextBaseline(a)};Pixel.Canvas.prototype.getTextWidth=function(a){return this.renderer.getTextWidth(a)};Pixel.Canvas.prototype.drawText=function(a,c,e){void 0!=c?this.renderer.drawText(a,c,e):this.renderer.drawText(a,this.cursorX,this.cursorY)};Pixel.Canvas.prototype.drawTextfield=function(a){this.renderer.drawTextfield(a)};
Pixel.Canvas.prototype.getNextDrawOrder=function(){this.drawOrderStack++;return this.drawOrderStack};Pixel.Canvas.prototype.resetDrawOrder=function(){this.drawOrderStack=0};Pixel.Canvas.prototype.mouseDownListener=function(a){this.bMouseDown=!0;a=Pixel.getRelativeMouseCoords(a,this.element);var c=new Pixel.MouseEvent(Pixel.MOUSE_DOWN_EVENT,a);Pixel.EventCenter.queueEvent(c,this);a=new Pixel.MouseEvent(Pixel.MOUSE_DOWN_INSIDE_EVENT,a);Pixel.EventCenter.queueEvent(a,this)};
Pixel.Canvas.prototype.mouseMovedListener=function(a){a=Pixel.getRelativeMouseCoords(a,this.element);a=new Pixel.MouseEvent(Pixel.MOUSE_MOVE_EVENT,a);Pixel.EventCenter.queueEvent(a,this)};Pixel.Canvas.prototype.mouseUpListener=function(a){this.bMouseDown=!1;a=Pixel.getRelativeMouseCoords(a,this.element);var c=new Pixel.MouseEvent(Pixel.MOUSE_UP_EVENT,a);Pixel.EventCenter.queueEvent(c,this);a=new Pixel.MouseEvent(Pixel.MOUSE_UP_INSIDE_EVENT,a);Pixel.EventCenter.queueEvent(a,this)};
Pixel.Canvas.prototype.keyDownListener=function(a){a=new Pixel.KeyEvent(Pixel.KEY_DOWN_EVENT,void 0!=a.which?a.which:a.charCode,a.keyCode);Pixel.EventCenter.queueEvent(a,this)};Pixel.Canvas.prototype.keyPressListener=function(a){a=new Pixel.KeyEvent(Pixel.KEY_PRESS_EVENT,void 0!=a.which?a.which:a.charCode,a.keyCode);Pixel.EventCenter.queueEvent(a,this)};
Pixel.Canvas.prototype.keyUpListener=function(a){a=new Pixel.KeyEvent(Pixel.KEY_UP_EVENT,void 0!=a.which?a.which:a.charCode,a.keyCode);Pixel.EventCenter.queueEvent(a,this)};Pixel.Renderer2D=function(a){this.type=Pixel.RENDERER_2D;this.ctx=a.getContext("2d");this.bFill=!0;this.bStroke=!1;this.bgColor=new Pixel.Color;this.shapePos={x:0,y:0};this.matrixStack=[];this.transformMatrix=mat4.create();this.translationVec=vec3.create();this.scaleVec=vec3.create();this.rotationAxisVec=vec3.create()};
Pixel.Renderer2D.prototype.setSize=function(a,c){};Pixel.Renderer2D.prototype.setBackgroundColor=function(a,c,e,f){this.bgColor.set(a,c,e,f)};Pixel.Renderer2D.prototype.clear=function(a,c,e,f){if(0<this.bgColor.a){this.setTransformation();var h=this.ctx.fillStyle;this.ctx.fillStyle=this.bgColor.toRGBAString();this.ctx.fillRect(a,c,e,f);this.ctx.fillStyle=h}else this.ctx.clearRect(a,c,e,f)};Pixel.Renderer2D.prototype.setAlpha=function(a){this.ctx.globalAlpha=a};
Pixel.Renderer2D.prototype.getAlpha=function(){return this.ctx.globalAlpha};Pixel.Renderer2D.prototype.setFillColor=function(a,c,e,f){this.ctx.fillStyle=Pixel.getColorAsRGBAString(a,c,e,f);this.bFill=!0};Pixel.Renderer2D.prototype.noFill=function(){this.bFill=!1};Pixel.Renderer2D.prototype.setStrokeColor=function(a,c,e,f){this.ctx.strokeStyle=Pixel.getColorAsRGBAString(a,c,e,f);this.bStroke=!0};Pixel.Renderer2D.prototype.noStroke=function(){this.bStroke=!1};
Pixel.Renderer2D.prototype.setStrokeSize=function(a){this.ctx.lineWidth=a};Pixel.Renderer2D.prototype.setLineCap=function(a){this.ctx.lineCap=a};Pixel.Renderer2D.prototype.shadow=function(a,c,e){this.ctx.shadowBlur=a;this.ctx.shadowOffsetX=c;this.ctx.shadowOffsetY=e};Pixel.Renderer2D.prototype.setShadowColor=function(a,c,e,f){this.ctx.shadowColor=Pixel.getColorAsString(a,c,e,f)};Pixel.Renderer2D.prototype.noShadow=function(){this.ctx.shadowBlur=0;this.ctx.shadowOffsetX=0;this.ctx.shadowOffsetY=0};
Pixel.Renderer2D.prototype.drawImage=function(a,c,e,f,h){this.ctx.drawImage(a,c,e,f,h)};Pixel.Renderer2D.prototype.beginShape=function(a,c){this.ctx.beginPath();this.ctx.moveTo(a,c);this.shapePos={x:a,y:c}};Pixel.Renderer2D.prototype.addVertex=function(a,c,e){this.ctx.lineTo(a,c);void 0!=e&&this.endShape();this.shapePos={x:a,y:c}};
Pixel.Renderer2D.prototype.curveVertex=function(a,c){var e,f,h,k;e=this.shapePos.x;f=this.shapePos.y;e>a&&f>c||e<a&&f<c?(h=a,k=f):(h=e,k=c);radius=(Math.abs(e-a)+Math.abs(f-c))/2;this.ctx.arcTo(h,k,a,c,radius);this.shapePos={x:a,y:c}};Pixel.Renderer2D.prototype.endShape=function(a,c){this.ctx.closePath();this.shapePos={x:a,y:c};this.ctx.fill()};Pixel.Renderer2D.prototype.drawLine=function(a,c,e,f){this.ctx.beginPath();this.ctx.moveTo(a,c);this.ctx.lineTo(e,f);this.ctx.stroke()};
Pixel.Renderer2D.prototype.dashedLine=function(a,c,e,f,h){var k=function(a,c){return a<=c},n=function(a,c){return a>=c},m=function(a,c){return Math.min(a,c)},p=function(a,c){return Math.max(a,c)},d={thereYet:n,cap:m},n={thereYet:n,cap:m};0<c-f&&(n.thereYet=k,n.cap=p);0<a-e&&(d.thereYet=k,d.cap=p);this.ctx.moveTo(a,c);this.ctx.beginPath();for(var k=a,p=c,m=0,l=!0;!d.thereYet(k,e)||!n.thereYet(p,f);){var Q=Math.atan2(f-c,e-a),R=h[m],k=d.cap(e,k+Math.cos(Q)*R),p=n.cap(f,p+Math.sin(Q)*R);l?this.ctx.lineTo(k,
p):this.ctx.moveTo(k,p);this.ctx.stroke();m=(m+1)%h.length;l=!l}};Pixel.Renderer2D.prototype.drawRect=function(a,c,e,f){void 0!=c?(this.bFill&&this.ctx.fillRect(a,c,e,f),this.bStroke&&this.ctx.strokeRect(a,c,e,f)):(this.bFill&&this.ctx.fillRect(a.x,a.y,a.width,a.height),this.bStroke&&this.ctx.strokeRect(a.x,a.y,a.width,a.height))};Pixel.Renderer2D.prototype.drawSquare=function(a,c,e){this.drawRect(a,c,e,e)};
Pixel.Renderer2D.prototype.drawRoundedRect=function(a,c,e,f,h){"number"===typeof h&&(h={tl:h,tr:h,br:h,bl:h});this.beginShape();this.addVertex(a+e-h.tr,c);this.curveVertex(a+e,c+h.tr);this.addVertex(a+e,c+f-h.br);this.curveVertex(a+e-h.br,c+f);this.addVertex(a+h.bl,c+f);this.curveVertex(a,c+f-h.bl);this.addVertex(a,c+h.tl);this.curveVertex(a+h.tl,c);this.endShape();this.bFill&&this.ctx.fill();this.bStroke&&this.ctx.stroke()};
Pixel.Renderer2D.prototype.drawEllipse=function(a,c,e,f){ox=0.5522848*(e/2);oy=0.5522848*(f/2);xe=a+e;ye=c+f;xm=a+e/2;ym=c+f/2;this.ctx.beginPath();this.ctx.moveTo(a,ym);this.ctx.bezierCurveTo(a,ym-oy,xm-ox,c,xm,c);this.ctx.bezierCurveTo(xm+ox,c,xe,ym-oy,xe,ym);this.ctx.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye);this.ctx.bezierCurveTo(xm-ox,ye,a,ym+oy,a,ym);this.ctx.closePath();this.bStroke&&this.ctx.stroke();this.bFill&&this.ctx.fill()};
Pixel.Renderer2D.prototype.drawCircle=function(a,c,e){this.ctx.beginPath();this.ctx.arc(a+e/2,c+e/2,e/2,0,2*Math.PI,!1);this.bStroke&&this.ctx.stroke();this.bFill&&this.ctx.fill()};Pixel.Renderer2D.prototype.pushMatrix=function(){this.matrixStack.push(this.transformMatrix);this.transformMatrix=mat4.create();mat4.multiply(this.transformMatrix,this.transformMatrix,this.matrixStack[this.matrixStack.length-1])};
Pixel.Renderer2D.prototype.popMatrix=function(){this.transformMatrix=this.matrixStack[this.matrixStack.length-1];this.matrixStack.splice(this.matrixStack.length-1,1)};Pixel.Renderer2D.prototype.translate=function(a,c){vec3.set(this.translationVec,a,c,0);mat4.translate(this.transformMatrix,this.transformMatrix,this.translationVec);this.setTransformation()};
Pixel.Renderer2D.prototype.scale=function(a,c){vec3.set(this.scaleVec,a,c,1);mat4.scale(this.transformMatrix,this.transformMatrix,this.scaleVec);this.setTransformation()};Pixel.Renderer2D.prototype.rotate=function(a){vec3.set(this.rotationAxisVec,0,0,1);mat4.rotate(this.transformMatrix,this.transformMatrix,a,this.rotationAxisVec);this.setTransformation()};Pixel.Renderer2D.prototype.transform=function(a,c,e,f,h,k){this.ctx.transform(a,c,e,f,h,k)};
Pixel.Renderer2D.prototype.setTransformation=function(){this.ctx.setTransform(this.transformMatrix[0],this.transformMatrix[1],this.transformMatrix[4],this.transformMatrix[5],this.transformMatrix[12],this.transformMatrix[13])};Pixel.Renderer2D.prototype.getTransformation=function(){return this.transformMatrix};Pixel.Renderer2D.prototype.setTransform=function(a,c,e,f,h,k){this.ctx.setTransform(a,c,e,f,h,k)};
Pixel.Renderer2D.prototype.setFont=function(a,c){void 0==c?(console.log(a),this.setFont(a.fontFamily,a.size)):this.ctx.font=c+"pt "+a;this.setTextAlignment(a.alignment);this.setTextBaseline(a.baseline)};Pixel.Renderer2D.prototype.setTextAlignment=function(a){this.ctx.textAlign=a};
Pixel.Renderer2D.prototype.setTextBaseline=function(a){switch(a){case Pixel.TEXT_BASELINE_TOP:this.ctx.textBaseline="top";break;case Pixel.TEXT_BASELINE_MIDDLE:this.ctx.textBaseline="middle";break;case Pixel.TEXT_BASELINE_BOTTOM:this.ctx.textBaseline="bottom"}};Pixel.Renderer2D.prototype.getTextWidth=function(a){return this.ctx.measureText(a).width};Pixel.Renderer2D.prototype.drawText=function(a,c,e){void 0!=c?this.ctx.fillText(a,c,e):this.ctx.fillText(a,this.cursorX,this.cursorY)};
Pixel.Renderer2D.prototype.drawTextfield=function(a){this.setFont(a.font);this.setFillColor(a.color);this.drawText(a.text,a.pos.x,a.pos.y)};Pixel.App=function(a){Pixel.Canvas.call(this,a);this.bSetup=!1;this.bRunning=!0;this.fps=60;this.curFPS=0;this.bShowFPS=!1;this.curFps=0;this.nFPSSamples=50;this.fpsElement=null;this.prevTime=this.startTime=(new Date).getTime();this.bClearBackground=!0;this.touches=[];this.bIsMobileApp=this.bMouseDown=!1};Pixel.App.prototype=Object.create(Pixel.Canvas.prototype);
Pixel.App.prototype.start=function(){this.bRunning=!0;this.run()};Pixel.App.prototype.stop=function(){this.bRunning=!1};Pixel.App.prototype.isRunning=function(){return this.bRunning};Pixel.App.prototype.run=function(){this.bRunning&&(this.calculateBounds(),Pixel.EventCenter.dispatchEvents(this),this.update(),this.bClearBackground&&this.clear(0,0,this.getWidth(),this.getHeight()),this.resetDrawOrder(),this.drawTree(),this.bShowFPS&&this.updateFPS(),window.requestAnimFrame(this.run.bind(this)))};
Pixel.App.prototype.setFPS=function(a){this.fps=a};Pixel.App.prototype.getFPS=function(){return this.fps};Pixel.App.prototype.showFPS=function(){null==this.fpsElement&&(this.fpsElement=document.createElement("div"),document.body.appendChild(this.fpsElement));this.curFPS=0;this.bShowFPS=!0};Pixel.App.prototype.hideFPS=function(){this.bShowFPS=!1};
Pixel.App.prototype.updateFPS=function(){var a=this.getElapsedTime();this.curFPS=(this.curFPS*(this.nFPSSamples-1)+1E3/(a-this.prevTime))/this.nFPSSamples;this.prevTime=a;this.fpsElement.innerHTML=this.curFPS};Pixel.App.prototype.getElapsedTime=function(){return(new Date).getTime()-this.startTime};
